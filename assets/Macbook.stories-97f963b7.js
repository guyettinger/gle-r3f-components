import{c as Se,u as nn,V as Be,l as jn,O as dt,m as bt,b as Le,R as Er,n as $r,o as On,p as Mr,q as rn,I as es,S as $t,r as ts,t as ns,v as rs,w as xt,x as Lt,Q as pn,g as nr,L as Yn,y as Wt,F as Bt,d as mt,z as ss,A as as,B as os,G as Ot,H as tt,a as Cn,J as is,K as cs,N as Ir,T as ls,W as us,X as Vt,Y as As,Z as Ye,_ as Fr,$ as Pn,P as hs,a0 as Rn,a1 as ds,a2 as Tr,a3 as fs,a4 as br,a5 as Bs,a6 as ms,a7 as ps,a8 as Cs,a9 as gs,aa as Dn,M as Yt,ab as vs,ac as Es,ad as Ms,ae as Rr,af as Is,ag as Fs,ah as Ts,ai as bs,aj as at,ak as Rs,al as Ds,am as ys,an as Gs,k as ot,ao as rr,ap as sr,aq as ar,ar as ws,as as Ss,at as Hs,au as Dr,av as Ze,aw as it,ax as Pt,ay as en,az as _s,i as tn,aA as yr,aB as Zn,aC as gn,aD as vn,aE as xs,aF as Ls,aG as Un,aH as Os,aI as Ps,aJ as Us,aK as Js,aL as Jn,aM as Ns,aN as or,aO as ks,aP as Ks,aQ as Qs,aR as Xs,aS as js,aT as Ys,aU as Zs,e as Ws,aV as ir,aW as Vs,s as Gr,j as Fe,aX as zt,C as zs}from"./react-three-fiber.esm-886f195d.js";import{r as N}from"./index-76fb7be0.js";import{_ as In}from"./extends-98964cd2.js";import{c as qs}from"./client-e770a681.js";import"./_commonjsHelpers-de833af9.js";const sn=new Be,Wn=new Be,$s=new Be,cr=new Le;function ea(l,e,n){const t=sn.setFromMatrixPosition(l.matrixWorld);t.project(e);const r=n.width/2,s=n.height/2;return[t.x*r+r,-(t.y*s)+s]}function ta(l,e){const n=sn.setFromMatrixPosition(l.matrixWorld),t=Wn.setFromMatrixPosition(e.matrixWorld),r=n.sub(t),s=e.getWorldDirection($s);return r.angleTo(s)>Math.PI/2}function na(l,e,n,t){const r=sn.setFromMatrixPosition(l.matrixWorld),s=r.clone();s.project(e),cr.set(s.x,s.y),n.setFromCamera(cr,e);const a=n.intersectObjects(t,!0);if(a.length){const c=a[0].distance;return r.distanceTo(n.ray.origin)<c}return!0}function ra(l,e){if(e instanceof dt)return e.zoom;if(e instanceof bt){const n=sn.setFromMatrixPosition(l.matrixWorld),t=Wn.setFromMatrixPosition(e.matrixWorld),r=e.fov*Math.PI/180,s=n.distanceTo(t);return 1/(2*Math.tan(r/2)*s)}else return 1}function sa(l,e,n){if(e instanceof bt||e instanceof dt){const t=sn.setFromMatrixPosition(l.matrixWorld),r=Wn.setFromMatrixPosition(e.matrixWorld),s=t.distanceTo(r),a=(n[1]-n[0])/(e.far-e.near),c=n[1]-a*e.far;return Math.round(a*s+c)}}const Nn=l=>Math.abs(l)<1e-10?0:l;function wr(l,e,n=""){let t="matrix3d(";for(let r=0;r!==16;r++)t+=Nn(e[r]*l.elements[r])+(r!==15?",":")");return n+t}const aa=(l=>e=>wr(e,l))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),oa=(l=>(e,n)=>wr(e,l(n),"translate(-50%,-50%)"))(l=>[1/l,1/l,1/l,1,-1/l,-1/l,-1/l,-1,1/l,1/l,1/l,1,1,1,1,1]);function ia(l){return l&&typeof l=="object"&&"current"in l}const ca=N.forwardRef(({children:l,eps:e=.001,style:n,className:t,prepend:r,center:s,fullscreen:a,portal:c,distanceFactor:i,sprite:A=!1,transform:h=!1,occlude:d,onOcclude:f,castShadow:C,receiveShadow:g,material:T,geometry:M,zIndexRange:I=[16777271,0],calculatePosition:L=ea,as:J="div",wrapperClass:U,pointerEvents:O="auto",...D},Y)=>{const{gl:b,camera:F,scene:P,size:j,raycaster:ee,events:$,viewport:k}=Se(),[z]=N.useState(()=>document.createElement(J)),W=N.useRef(),ce=N.useRef(null),Ee=N.useRef(0),ge=N.useRef([0,0]),ne=N.useRef(null),Me=N.useRef(null),se=(c==null?void 0:c.current)||$.connected||b.domElement.parentNode,le=N.useRef(null),ye=N.useRef(!1),Oe=N.useMemo(()=>d&&d!=="blending"||Array.isArray(d)&&d.length&&ia(d[0]),[d]);N.useLayoutEffect(()=>{const Ge=b.domElement;d&&d==="blending"?(Ge.style.zIndex=`${Math.floor(I[0]/2)}`,Ge.style.position="absolute",Ge.style.pointerEvents="none"):(Ge.style.zIndex=null,Ge.style.position=null,Ge.style.pointerEvents=null)},[d]),N.useLayoutEffect(()=>{if(ce.current){const Ge=W.current=qs(z);if(P.updateMatrixWorld(),h)z.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const ie=L(ce.current,F,j);z.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${ie[0]}px,${ie[1]}px,0);transform-origin:0 0;`}return se&&(r?se.prepend(z):se.appendChild(z)),()=>{se&&se.removeChild(z),Ge.unmount()}}},[se,h]),N.useLayoutEffect(()=>{U&&(z.className=U)},[U]);const oe=N.useMemo(()=>h?{position:"absolute",top:0,left:0,width:j.width,height:j.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...a&&{top:-j.height/2,left:-j.width/2,width:j.width,height:j.height},...n},[n,s,a,j,h]),Pe=N.useMemo(()=>({position:"absolute",pointerEvents:O}),[O]);N.useLayoutEffect(()=>{if(ye.current=!1,h){var Ge;(Ge=W.current)==null||Ge.render(N.createElement("div",{ref:ne,style:oe},N.createElement("div",{ref:Me,style:Pe},N.createElement("div",{ref:Y,className:t,style:n,children:l}))))}else{var ie;(ie=W.current)==null||ie.render(N.createElement("div",{ref:Y,style:oe,className:t,children:l}))}});const be=N.useRef(!0);nn(Ge=>{if(ce.current){F.updateMatrixWorld(),ce.current.updateWorldMatrix(!0,!1);const ie=h?ge.current:L(ce.current,F,j);if(h||Math.abs(Ee.current-F.zoom)>e||Math.abs(ge.current[0]-ie[0])>e||Math.abs(ge.current[1]-ie[1])>e){const Ne=ta(ce.current,F);let He=!1;Oe&&(Array.isArray(d)?He=d.map(ke=>ke.current):d!=="blending"&&(He=[P]));const qe=be.current;if(He){const ke=na(ce.current,F,ee,He);be.current=ke&&!Ne}else be.current=!Ne;qe!==be.current&&(f?f(!be.current):z.style.display=be.current?"block":"none");const nt=Math.floor(I[0]/2),yt=d?Oe?[I[0],nt]:[nt-1,0]:I;if(z.style.zIndex=`${sa(ce.current,F,yt)}`,h){const[ke,pt]=[j.width/2,j.height/2],Ct=F.projectionMatrix.elements[5]*pt,{isOrthographicCamera:Gt,top:wt,left:gt,bottom:$e,right:Jt}=F,vt=aa(F.matrixWorldInverse),St=Gt?`scale(${Ct})translate(${Nn(-(Jt+gt)/2)}px,${Nn((wt+$e)/2)}px)`:`translateZ(${Ct}px)`;let Ue=ce.current.matrixWorld;A&&(Ue=F.matrixWorldInverse.clone().transpose().copyPosition(Ue).scale(ce.current.scale),Ue.elements[3]=Ue.elements[7]=Ue.elements[11]=0,Ue.elements[15]=1),z.style.width=j.width+"px",z.style.height=j.height+"px",z.style.perspective=Gt?"":`${Ct}px`,ne.current&&Me.current&&(ne.current.style.transform=`${St}${vt}translate(${ke}px,${pt}px)`,Me.current.style.transform=oa(Ue,1/((i||10)/400)))}else{const ke=i===void 0?1:ra(ce.current,F)*i;z.style.transform=`translate3d(${ie[0]}px,${ie[1]}px,0) scale(${ke})`}ge.current=ie,Ee.current=F.zoom}}if(!Oe&&le.current&&!ye.current)if(h){if(ne.current){const ie=ne.current.children[0];if(ie!=null&&ie.clientWidth&&ie!=null&&ie.clientHeight){const{isOrthographicCamera:Ne}=F;if(Ne||M)D.scale&&(Array.isArray(D.scale)?D.scale instanceof Be?le.current.scale.copy(D.scale.clone().divideScalar(1)):le.current.scale.set(1/D.scale[0],1/D.scale[1],1/D.scale[2]):le.current.scale.setScalar(1/D.scale));else{const He=(i||10)/400,qe=ie.clientWidth*He,nt=ie.clientHeight*He;le.current.scale.set(qe,nt,1)}ye.current=!0}}}else{const ie=z.children[0];if(ie!=null&&ie.clientWidth&&ie!=null&&ie.clientHeight){const Ne=1/k.factor,He=ie.clientWidth*Ne,qe=ie.clientHeight*Ne;le.current.scale.set(He,qe,1),ye.current=!0}le.current.lookAt(Ge.camera.position)}});const Dt=N.useMemo(()=>({vertexShader:h?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[h]);return N.createElement("group",In({},D,{ref:ce}),d&&!Oe&&N.createElement("mesh",{castShadow:C,receiveShadow:g,ref:le},M||N.createElement("planeGeometry",null),T||N.createElement("shaderMaterial",{side:jn,vertexShader:Dt.vertexShader,fragmentShader:Dt.fragmentShader})))}),la=parseInt(Er.replace(/\D+/g,""));function lr(l,e){if(e===$r)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),l;if(e===On||e===Mr){let n=l.getIndex();if(n===null){const a=[],c=l.getAttribute("position");if(c!==void 0){for(let i=0;i<c.count;i++)a.push(i);l.setIndex(a),n=l.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),l}const t=n.count-2,r=[];if(n)if(e===On)for(let a=1;a<=t;a++)r.push(n.getX(0)),r.push(n.getX(a)),r.push(n.getX(a+1));else for(let a=0;a<t;a++)a%2===0?(r.push(n.getX(a)),r.push(n.getX(a+1)),r.push(n.getX(a+2))):(r.push(n.getX(a+2)),r.push(n.getX(a+1)),r.push(n.getX(a)));r.length/3!==t&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=l.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),l}var je=Uint8Array,ft=Uint16Array,kn=Uint32Array,Sr=new je([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Hr=new je([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ua=new je([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),_r=function(l,e){for(var n=new ft(31),t=0;t<31;++t)n[t]=e+=1<<l[t-1];for(var r=new kn(n[30]),t=1;t<30;++t)for(var s=n[t];s<n[t+1];++s)r[s]=s-n[t]<<5|t;return[n,r]},xr=_r(Sr,2),Lr=xr[0],Aa=xr[1];Lr[28]=258,Aa[258]=28;var ha=_r(Hr,0),da=ha[0],Kn=new ft(32768);for(var pe=0;pe<32768;++pe){var At=(pe&43690)>>>1|(pe&21845)<<1;At=(At&52428)>>>2|(At&13107)<<2,At=(At&61680)>>>4|(At&3855)<<4,Kn[pe]=((At&65280)>>>8|(At&255)<<8)>>>1}var qt=function(l,e,n){for(var t=l.length,r=0,s=new ft(e);r<t;++r)++s[l[r]-1];var a=new ft(e);for(r=0;r<e;++r)a[r]=a[r-1]+s[r-1]<<1;var c;if(n){c=new ft(1<<e);var i=15-e;for(r=0;r<t;++r)if(l[r])for(var A=r<<4|l[r],h=e-l[r],d=a[l[r]-1]++<<h,f=d|(1<<h)-1;d<=f;++d)c[Kn[d]>>>i]=A}else for(c=new ft(t),r=0;r<t;++r)l[r]&&(c[r]=Kn[a[l[r]-1]++]>>>15-l[r]);return c},an=new je(288);for(var pe=0;pe<144;++pe)an[pe]=8;for(var pe=144;pe<256;++pe)an[pe]=9;for(var pe=256;pe<280;++pe)an[pe]=7;for(var pe=280;pe<288;++pe)an[pe]=8;var Or=new je(32);for(var pe=0;pe<32;++pe)Or[pe]=5;var fa=qt(an,9,1),Ba=qt(Or,5,1),yn=function(l){for(var e=l[0],n=1;n<l.length;++n)l[n]>e&&(e=l[n]);return e},ze=function(l,e,n){var t=e/8|0;return(l[t]|l[t+1]<<8)>>(e&7)&n},Gn=function(l,e){var n=e/8|0;return(l[n]|l[n+1]<<8|l[n+2]<<16)>>(e&7)},ma=function(l){return(l/8|0)+(l&7&&1)},pa=function(l,e,n){(e==null||e<0)&&(e=0),(n==null||n>l.length)&&(n=l.length);var t=new(l instanceof ft?ft:l instanceof kn?kn:je)(n-e);return t.set(l.subarray(e,n)),t},Ca=function(l,e,n){var t=l.length;if(!t||n&&!n.l&&t<5)return e||new je(0);var r=!e||n,s=!n||n.i;n||(n={}),e||(e=new je(t*3));var a=function(oe){var Pe=e.length;if(oe>Pe){var be=new je(Math.max(Pe*2,oe));be.set(e),e=be}},c=n.f||0,i=n.p||0,A=n.b||0,h=n.l,d=n.d,f=n.m,C=n.n,g=t*8;do{if(!h){n.f=c=ze(l,i,1);var T=ze(l,i+1,3);if(i+=3,T)if(T==1)h=fa,d=Ba,f=9,C=5;else if(T==2){var J=ze(l,i,31)+257,U=ze(l,i+10,15)+4,O=J+ze(l,i+5,31)+1;i+=14;for(var D=new je(O),Y=new je(19),b=0;b<U;++b)Y[ua[b]]=ze(l,i+b*3,7);i+=U*3;for(var F=yn(Y),P=(1<<F)-1,j=qt(Y,F,1),b=0;b<O;){var ee=j[ze(l,i,P)];i+=ee&15;var M=ee>>>4;if(M<16)D[b++]=M;else{var $=0,k=0;for(M==16?(k=3+ze(l,i,3),i+=2,$=D[b-1]):M==17?(k=3+ze(l,i,7),i+=3):M==18&&(k=11+ze(l,i,127),i+=7);k--;)D[b++]=$}}var z=D.subarray(0,J),W=D.subarray(J);f=yn(z),C=yn(W),h=qt(z,f,1),d=qt(W,C,1)}else throw"invalid block type";else{var M=ma(i)+4,I=l[M-4]|l[M-3]<<8,L=M+I;if(L>t){if(s)throw"unexpected EOF";break}r&&a(A+I),e.set(l.subarray(M,L),A),n.b=A+=I,n.p=i=L*8;continue}if(i>g){if(s)throw"unexpected EOF";break}}r&&a(A+131072);for(var ce=(1<<f)-1,Ee=(1<<C)-1,ge=i;;ge=i){var $=h[Gn(l,i)&ce],ne=$>>>4;if(i+=$&15,i>g){if(s)throw"unexpected EOF";break}if(!$)throw"invalid length/literal";if(ne<256)e[A++]=ne;else if(ne==256){ge=i,h=null;break}else{var Me=ne-254;if(ne>264){var b=ne-257,se=Sr[b];Me=ze(l,i,(1<<se)-1)+Lr[b],i+=se}var le=d[Gn(l,i)&Ee],ye=le>>>4;if(!le)throw"invalid distance";i+=le&15;var W=da[ye];if(ye>3){var se=Hr[ye];W+=Gn(l,i)&(1<<se)-1,i+=se}if(i>g){if(s)throw"unexpected EOF";break}r&&a(A+131072);for(var Oe=A+Me;A<Oe;A+=4)e[A]=e[A-W],e[A+1]=e[A+1-W],e[A+2]=e[A+2-W],e[A+3]=e[A+3-W];A=Oe}}n.l=h,n.p=ge,n.b=A,h&&(c=1,n.m=f,n.d=d,n.n=C)}while(!c);return A==e.length?e:pa(e,0,A)},ga=new je(0),va=function(l){if((l[0]&15)!=8||l[0]>>>4>7||(l[0]<<8|l[1])%31)throw"invalid zlib data";if(l[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function An(l,e){return Ca((va(l),l.subarray(2,-4)),e)}var Ea=typeof TextDecoder<"u"&&new TextDecoder,Ma=0;try{Ea.decode(ga,{stream:!0}),Ma=1}catch{}const Ia=l=>l&&l.isCubeTexture;class Fa extends rn{constructor(e,n){var t,r;const s=Ia(e),c=((r=s?(t=e.image[0])==null?void 0:t.width:e.image.width)!=null?r:1024)/4,i=Math.floor(Math.log2(c)),A=Math.pow(2,i),h=3*Math.max(A,16*7),d=4*A,f=[s?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/h}`,`#define CUBEUV_TEXEL_HEIGHT ${1/d}`,`#define CUBEUV_MAX_MIP ${i}.0`],C=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,g=f.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${parseInt(Er.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,T={map:{value:e},height:{value:(n==null?void 0:n.height)||15},radius:{value:(n==null?void 0:n.radius)||100}},M=new es(1,16),I=new $t({uniforms:T,fragmentShader:g,vertexShader:C,side:jn});super(M,I)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}var Ta=Object.defineProperty,ba=(l,e,n)=>e in l?Ta(l,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[e]=n,V=(l,e,n)=>(ba(l,typeof e!="symbol"?e+"":e,n),n);const hn=new ts,ur=new ns,Ra=Math.cos(70*(Math.PI/180)),Ar=(l,e)=>(l%e+e)%e;let Da=class extends rs{constructor(e,n){super(),V(this,"object"),V(this,"domElement"),V(this,"enabled",!0),V(this,"target",new Be),V(this,"minDistance",0),V(this,"maxDistance",1/0),V(this,"minZoom",0),V(this,"maxZoom",1/0),V(this,"minPolarAngle",0),V(this,"maxPolarAngle",Math.PI),V(this,"minAzimuthAngle",-1/0),V(this,"maxAzimuthAngle",1/0),V(this,"enableDamping",!1),V(this,"dampingFactor",.05),V(this,"enableZoom",!0),V(this,"zoomSpeed",1),V(this,"enableRotate",!0),V(this,"rotateSpeed",1),V(this,"enablePan",!0),V(this,"panSpeed",1),V(this,"screenSpacePanning",!0),V(this,"keyPanSpeed",7),V(this,"zoomToCursor",!1),V(this,"autoRotate",!1),V(this,"autoRotateSpeed",2),V(this,"reverseOrbit",!1),V(this,"reverseHorizontalOrbit",!1),V(this,"reverseVerticalOrbit",!1),V(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),V(this,"mouseButtons",{LEFT:xt.ROTATE,MIDDLE:xt.DOLLY,RIGHT:xt.PAN}),V(this,"touches",{ONE:Lt.ROTATE,TWO:Lt.DOLLY_PAN}),V(this,"target0"),V(this,"position0"),V(this,"zoom0"),V(this,"_domElementKeyEvents",null),V(this,"getPolarAngle"),V(this,"getAzimuthalAngle"),V(this,"setPolarAngle"),V(this,"setAzimuthalAngle"),V(this,"getDistance"),V(this,"listenToKeyEvents"),V(this,"stopListenToKeyEvents"),V(this,"saveState"),V(this,"reset"),V(this,"update"),V(this,"connect"),V(this,"dispose"),this.object=e,this.domElement=n,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>h.phi,this.getAzimuthalAngle=()=>h.theta,this.setPolarAngle=m=>{let G=Ar(m,2*Math.PI),K=h.phi;K<0&&(K+=2*Math.PI),G<0&&(G+=2*Math.PI);let Z=Math.abs(G-K);2*Math.PI-Z<Z&&(G<K?G+=2*Math.PI:K+=2*Math.PI),d.phi=G-K,t.update()},this.setAzimuthalAngle=m=>{let G=Ar(m,2*Math.PI),K=h.theta;K<0&&(K+=2*Math.PI),G<0&&(G+=2*Math.PI);let Z=Math.abs(G-K);2*Math.PI-Z<Z&&(G<K?G+=2*Math.PI:K+=2*Math.PI),d.theta=G-K,t.update()},this.getDistance=()=>t.object.position.distanceTo(t.target),this.listenToKeyEvents=m=>{m.addEventListener("keydown",Ue),this._domElementKeyEvents=m},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Ue),this._domElementKeyEvents=null},this.saveState=()=>{t.target0.copy(t.target),t.position0.copy(t.object.position),t.zoom0=t.object.zoom},this.reset=()=>{t.target.copy(t.target0),t.object.position.copy(t.position0),t.object.zoom=t.zoom0,t.object.updateProjectionMatrix(),t.dispatchEvent(r),t.update(),i=c.NONE},this.update=(()=>{const m=new Be,G=new Be(0,1,0),K=new pn().setFromUnitVectors(e.up,G),Z=K.clone().invert(),Ie=new Be,x=new pn,xe=2*Math.PI;return function(){const ln=t.object.position;K.setFromUnitVectors(e.up,G),Z.copy(K).invert(),m.copy(ln).sub(t.target),m.applyQuaternion(K),h.setFromVector3(m),t.autoRotate&&i===c.NONE&&k(ee()),t.enableDamping?(h.theta+=d.theta*t.dampingFactor,h.phi+=d.phi*t.dampingFactor):(h.theta+=d.theta,h.phi+=d.phi);let We=t.minAzimuthAngle,Ve=t.maxAzimuthAngle;isFinite(We)&&isFinite(Ve)&&(We<-Math.PI?We+=xe:We>Math.PI&&(We-=xe),Ve<-Math.PI?Ve+=xe:Ve>Math.PI&&(Ve-=xe),We<=Ve?h.theta=Math.max(We,Math.min(Ve,h.theta)):h.theta=h.theta>(We+Ve)/2?Math.max(We,h.theta):Math.min(Ve,h.theta)),h.phi=Math.max(t.minPolarAngle,Math.min(t.maxPolarAngle,h.phi)),h.makeSafe(),t.enableDamping===!0?t.target.addScaledVector(C,t.dampingFactor):t.target.add(C),t.zoomToCursor&&F||t.object.isOrthographicCamera?h.radius=se(h.radius):h.radius=se(h.radius*f),m.setFromSpherical(h),m.applyQuaternion(Z),ln.copy(t.target).add(m),t.object.matrixAutoUpdate||t.object.updateMatrix(),t.object.lookAt(t.target),t.enableDamping===!0?(d.theta*=1-t.dampingFactor,d.phi*=1-t.dampingFactor,C.multiplyScalar(1-t.dampingFactor)):(d.set(0,0,0),C.set(0,0,0));let Et=!1;if(t.zoomToCursor&&F){let Mt=null;if(t.object instanceof bt&&t.object.isPerspectiveCamera){const It=m.length();Mt=se(It*f);const _t=It-Mt;t.object.position.addScaledVector(Y,_t),t.object.updateMatrixWorld()}else if(t.object.isOrthographicCamera){const It=new Be(b.x,b.y,0);It.unproject(t.object),t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom/f)),t.object.updateProjectionMatrix(),Et=!0;const _t=new Be(b.x,b.y,0);_t.unproject(t.object),t.object.position.sub(_t).add(It),t.object.updateMatrixWorld(),Mt=m.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),t.zoomToCursor=!1;Mt!==null&&(t.screenSpacePanning?t.target.set(0,0,-1).transformDirection(t.object.matrix).multiplyScalar(Mt).add(t.object.position):(hn.origin.copy(t.object.position),hn.direction.set(0,0,-1).transformDirection(t.object.matrix),Math.abs(t.object.up.dot(hn.direction))<Ra?e.lookAt(t.target):(ur.setFromNormalAndCoplanarPoint(t.object.up,t.target),hn.intersectPlane(ur,t.target))))}else t.object instanceof dt&&t.object.isOrthographicCamera&&(Et=f!==1,Et&&(t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom/f)),t.object.updateProjectionMatrix()));return f=1,F=!1,Et||Ie.distanceToSquared(t.object.position)>A||8*(1-x.dot(t.object.quaternion))>A?(t.dispatchEvent(r),Ie.copy(t.object.position),x.copy(t.object.quaternion),Et=!1,!0):!1}})(),this.connect=m=>{m===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),t.domElement=m,t.domElement.style.touchAction="none",t.domElement.addEventListener("contextmenu",cn),t.domElement.addEventListener("pointerdown",wt),t.domElement.addEventListener("pointercancel",$e),t.domElement.addEventListener("wheel",St)},this.dispose=()=>{var m,G,K,Z,Ie,x;t.domElement&&(t.domElement.style.touchAction="auto"),(m=t.domElement)==null||m.removeEventListener("contextmenu",cn),(G=t.domElement)==null||G.removeEventListener("pointerdown",wt),(K=t.domElement)==null||K.removeEventListener("pointercancel",$e),(Z=t.domElement)==null||Z.removeEventListener("wheel",St),(Ie=t.domElement)==null||Ie.ownerDocument.removeEventListener("pointermove",gt),(x=t.domElement)==null||x.ownerDocument.removeEventListener("pointerup",$e),t._domElementKeyEvents!==null&&t._domElementKeyEvents.removeEventListener("keydown",Ue)};const t=this,r={type:"change"},s={type:"start"},a={type:"end"},c={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let i=c.NONE;const A=1e-6,h=new nr,d=new nr;let f=1;const C=new Be,g=new Le,T=new Le,M=new Le,I=new Le,L=new Le,J=new Le,U=new Le,O=new Le,D=new Le,Y=new Be,b=new Le;let F=!1;const P=[],j={};function ee(){return 2*Math.PI/60/60*t.autoRotateSpeed}function $(){return Math.pow(.95,t.zoomSpeed)}function k(m){t.reverseOrbit||t.reverseHorizontalOrbit?d.theta+=m:d.theta-=m}function z(m){t.reverseOrbit||t.reverseVerticalOrbit?d.phi+=m:d.phi-=m}const W=(()=>{const m=new Be;return function(K,Z){m.setFromMatrixColumn(Z,0),m.multiplyScalar(-K),C.add(m)}})(),ce=(()=>{const m=new Be;return function(K,Z){t.screenSpacePanning===!0?m.setFromMatrixColumn(Z,1):(m.setFromMatrixColumn(Z,0),m.crossVectors(t.object.up,m)),m.multiplyScalar(K),C.add(m)}})(),Ee=(()=>{const m=new Be;return function(K,Z){const Ie=t.domElement;if(Ie&&t.object instanceof bt&&t.object.isPerspectiveCamera){const x=t.object.position;m.copy(x).sub(t.target);let xe=m.length();xe*=Math.tan(t.object.fov/2*Math.PI/180),W(2*K*xe/Ie.clientHeight,t.object.matrix),ce(2*Z*xe/Ie.clientHeight,t.object.matrix)}else Ie&&t.object instanceof dt&&t.object.isOrthographicCamera?(W(K*(t.object.right-t.object.left)/t.object.zoom/Ie.clientWidth,t.object.matrix),ce(Z*(t.object.top-t.object.bottom)/t.object.zoom/Ie.clientHeight,t.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),t.enablePan=!1)}})();function ge(m){t.object instanceof bt&&t.object.isPerspectiveCamera||t.object instanceof dt&&t.object.isOrthographicCamera?f/=m:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),t.enableZoom=!1)}function ne(m){t.object instanceof bt&&t.object.isPerspectiveCamera||t.object instanceof dt&&t.object.isOrthographicCamera?f*=m:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),t.enableZoom=!1)}function Me(m){if(!t.zoomToCursor||!t.domElement)return;F=!0;const G=t.domElement.getBoundingClientRect(),K=m.clientX-G.left,Z=m.clientY-G.top,Ie=G.width,x=G.height;b.x=K/Ie*2-1,b.y=-(Z/x)*2+1,Y.set(b.x,b.y,1).unproject(t.object).sub(t.object.position).normalize()}function se(m){return Math.max(t.minDistance,Math.min(t.maxDistance,m))}function le(m){g.set(m.clientX,m.clientY)}function ye(m){Me(m),U.set(m.clientX,m.clientY)}function Oe(m){I.set(m.clientX,m.clientY)}function oe(m){T.set(m.clientX,m.clientY),M.subVectors(T,g).multiplyScalar(t.rotateSpeed);const G=t.domElement;G&&(k(2*Math.PI*M.x/G.clientHeight),z(2*Math.PI*M.y/G.clientHeight)),g.copy(T),t.update()}function Pe(m){O.set(m.clientX,m.clientY),D.subVectors(O,U),D.y>0?ge($()):D.y<0&&ne($()),U.copy(O),t.update()}function be(m){L.set(m.clientX,m.clientY),J.subVectors(L,I).multiplyScalar(t.panSpeed),Ee(J.x,J.y),I.copy(L),t.update()}function Dt(m){Me(m),m.deltaY<0?ne($()):m.deltaY>0&&ge($()),t.update()}function Ge(m){let G=!1;switch(m.code){case t.keys.UP:Ee(0,t.keyPanSpeed),G=!0;break;case t.keys.BOTTOM:Ee(0,-t.keyPanSpeed),G=!0;break;case t.keys.LEFT:Ee(t.keyPanSpeed,0),G=!0;break;case t.keys.RIGHT:Ee(-t.keyPanSpeed,0),G=!0;break}G&&(m.preventDefault(),t.update())}function ie(){if(P.length==1)g.set(P[0].pageX,P[0].pageY);else{const m=.5*(P[0].pageX+P[1].pageX),G=.5*(P[0].pageY+P[1].pageY);g.set(m,G)}}function Ne(){if(P.length==1)I.set(P[0].pageX,P[0].pageY);else{const m=.5*(P[0].pageX+P[1].pageX),G=.5*(P[0].pageY+P[1].pageY);I.set(m,G)}}function He(){const m=P[0].pageX-P[1].pageX,G=P[0].pageY-P[1].pageY,K=Math.sqrt(m*m+G*G);U.set(0,K)}function qe(){t.enableZoom&&He(),t.enablePan&&Ne()}function nt(){t.enableZoom&&He(),t.enableRotate&&ie()}function yt(m){if(P.length==1)T.set(m.pageX,m.pageY);else{const K=Re(m),Z=.5*(m.pageX+K.x),Ie=.5*(m.pageY+K.y);T.set(Z,Ie)}M.subVectors(T,g).multiplyScalar(t.rotateSpeed);const G=t.domElement;G&&(k(2*Math.PI*M.x/G.clientHeight),z(2*Math.PI*M.y/G.clientHeight)),g.copy(T)}function ke(m){if(P.length==1)L.set(m.pageX,m.pageY);else{const G=Re(m),K=.5*(m.pageX+G.x),Z=.5*(m.pageY+G.y);L.set(K,Z)}J.subVectors(L,I).multiplyScalar(t.panSpeed),Ee(J.x,J.y),I.copy(L)}function pt(m){const G=Re(m),K=m.pageX-G.x,Z=m.pageY-G.y,Ie=Math.sqrt(K*K+Z*Z);O.set(0,Ie),D.set(0,Math.pow(O.y/U.y,t.zoomSpeed)),ge(D.y),U.copy(O)}function Ct(m){t.enableZoom&&pt(m),t.enablePan&&ke(m)}function Gt(m){t.enableZoom&&pt(m),t.enableRotate&&yt(m)}function wt(m){var G,K;t.enabled!==!1&&(P.length===0&&((G=t.domElement)==null||G.ownerDocument.addEventListener("pointermove",gt),(K=t.domElement)==null||K.ownerDocument.addEventListener("pointerup",$e)),Tn(m),m.pointerType==="touch"?on(m):Jt(m))}function gt(m){t.enabled!==!1&&(m.pointerType==="touch"?Ht(m):vt(m))}function $e(m){var G,K,Z;bn(m),P.length===0&&((G=t.domElement)==null||G.releasePointerCapture(m.pointerId),(K=t.domElement)==null||K.ownerDocument.removeEventListener("pointermove",gt),(Z=t.domElement)==null||Z.ownerDocument.removeEventListener("pointerup",$e)),t.dispatchEvent(a),i=c.NONE}function Jt(m){let G;switch(m.button){case 0:G=t.mouseButtons.LEFT;break;case 1:G=t.mouseButtons.MIDDLE;break;case 2:G=t.mouseButtons.RIGHT;break;default:G=-1}switch(G){case xt.DOLLY:if(t.enableZoom===!1)return;ye(m),i=c.DOLLY;break;case xt.ROTATE:if(m.ctrlKey||m.metaKey||m.shiftKey){if(t.enablePan===!1)return;Oe(m),i=c.PAN}else{if(t.enableRotate===!1)return;le(m),i=c.ROTATE}break;case xt.PAN:if(m.ctrlKey||m.metaKey||m.shiftKey){if(t.enableRotate===!1)return;le(m),i=c.ROTATE}else{if(t.enablePan===!1)return;Oe(m),i=c.PAN}break;default:i=c.NONE}i!==c.NONE&&t.dispatchEvent(s)}function vt(m){if(t.enabled!==!1)switch(i){case c.ROTATE:if(t.enableRotate===!1)return;oe(m);break;case c.DOLLY:if(t.enableZoom===!1)return;Pe(m);break;case c.PAN:if(t.enablePan===!1)return;be(m);break}}function St(m){t.enabled===!1||t.enableZoom===!1||i!==c.NONE&&i!==c.ROTATE||(m.preventDefault(),t.dispatchEvent(s),Dt(m),t.dispatchEvent(a))}function Ue(m){t.enabled===!1||t.enablePan===!1||Ge(m)}function on(m){switch(lt(m),P.length){case 1:switch(t.touches.ONE){case Lt.ROTATE:if(t.enableRotate===!1)return;ie(),i=c.TOUCH_ROTATE;break;case Lt.PAN:if(t.enablePan===!1)return;Ne(),i=c.TOUCH_PAN;break;default:i=c.NONE}break;case 2:switch(t.touches.TWO){case Lt.DOLLY_PAN:if(t.enableZoom===!1&&t.enablePan===!1)return;qe(),i=c.TOUCH_DOLLY_PAN;break;case Lt.DOLLY_ROTATE:if(t.enableZoom===!1&&t.enableRotate===!1)return;nt(),i=c.TOUCH_DOLLY_ROTATE;break;default:i=c.NONE}break;default:i=c.NONE}i!==c.NONE&&t.dispatchEvent(s)}function Ht(m){switch(lt(m),i){case c.TOUCH_ROTATE:if(t.enableRotate===!1)return;yt(m),t.update();break;case c.TOUCH_PAN:if(t.enablePan===!1)return;ke(m),t.update();break;case c.TOUCH_DOLLY_PAN:if(t.enableZoom===!1&&t.enablePan===!1)return;Ct(m),t.update();break;case c.TOUCH_DOLLY_ROTATE:if(t.enableZoom===!1&&t.enableRotate===!1)return;Gt(m),t.update();break;default:i=c.NONE}}function cn(m){t.enabled!==!1&&m.preventDefault()}function Tn(m){P.push(m)}function bn(m){delete j[m.pointerId];for(let G=0;G<P.length;G++)if(P[G].pointerId==m.pointerId){P.splice(G,1);return}}function lt(m){let G=j[m.pointerId];G===void 0&&(G=new Le,j[m.pointerId]=G),G.set(m.pageX,m.pageY)}function Re(m){const G=m.pointerId===P[0].pointerId?P[1]:P[0];return j[G.pointerId]}n!==void 0&&this.connect(n),this.update()}};function En(l){if(typeof TextDecoder<"u")return new TextDecoder().decode(l);let e="";for(let n=0,t=l.length;n<t;n++)e+=String.fromCharCode(l[n]);try{return decodeURIComponent(escape(e))}catch{return e}}const Rt="srgb",ct="srgb-linear",hr=3001,ya=3e3;class Vn extends Yn{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(n){return new _a(n)}),this.register(function(n){return new xa(n)}),this.register(function(n){return new Qa(n)}),this.register(function(n){return new Xa(n)}),this.register(function(n){return new ja(n)}),this.register(function(n){return new Oa(n)}),this.register(function(n){return new Pa(n)}),this.register(function(n){return new Ua(n)}),this.register(function(n){return new Ja(n)}),this.register(function(n){return new Ha(n)}),this.register(function(n){return new Na(n)}),this.register(function(n){return new La(n)}),this.register(function(n){return new Ka(n)}),this.register(function(n){return new ka(n)}),this.register(function(n){return new wa(n)}),this.register(function(n){return new Ya(n)}),this.register(function(n){return new Za(n)})}load(e,n,t,r){const s=this;let a;if(this.resourcePath!=="")a=this.resourcePath;else if(this.path!==""){const A=Wt.extractUrlBase(e);a=Wt.resolveURL(A,this.path)}else a=Wt.extractUrlBase(e);this.manager.itemStart(e);const c=function(A){r?r(A):console.error(A),s.manager.itemError(e),s.manager.itemEnd(e)},i=new Bt(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,function(A){try{s.parse(A,a,function(h){n(h),s.manager.itemEnd(e)},c)}catch(h){c(h)}},t,c)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,n,t,r){let s;const a={},c={};if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(En(new Uint8Array(e.slice(0,4)))===Pr){try{a[re.KHR_BINARY_GLTF]=new Wa(e)}catch(h){r&&r(h);return}s=JSON.parse(a[re.KHR_BINARY_GLTF].content)}else s=JSON.parse(En(new Uint8Array(e)));else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const i=new co(s,{path:n||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});i.fileLoader.setRequestHeader(this.requestHeader);for(let A=0;A<this.pluginCallbacks.length;A++){const h=this.pluginCallbacks[A](i);h.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),c[h.name]=h,a[h.name]=!0}if(s.extensionsUsed)for(let A=0;A<s.extensionsUsed.length;++A){const h=s.extensionsUsed[A],d=s.extensionsRequired||[];switch(h){case re.KHR_MATERIALS_UNLIT:a[h]=new Sa;break;case re.KHR_DRACO_MESH_COMPRESSION:a[h]=new Va(s,this.dracoLoader);break;case re.KHR_TEXTURE_TRANSFORM:a[h]=new za;break;case re.KHR_MESH_QUANTIZATION:a[h]=new qa;break;default:d.indexOf(h)>=0&&c[h]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}i.setExtensions(a),i.setPlugins(c),i.parse(t,r)}parseAsync(e,n){const t=this;return new Promise(function(r,s){t.parse(e,n,r,s)})}}function Ga(){let l={};return{get:function(e){return l[e]},add:function(e,n){l[e]=n},remove:function(e){delete l[e]},removeAll:function(){l={}}}}const re={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class wa{constructor(e){this.parser=e,this.name=re.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,n=this.parser.json.nodes||[];for(let t=0,r=n.length;t<r;t++){const s=n[t];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const n=this.parser,t="light:"+e;let r=n.cache.get(t);if(r)return r;const s=n.json,i=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let A;const h=new mt(16777215);i.color!==void 0&&h.setRGB(i.color[0],i.color[1],i.color[2],ct);const d=i.range!==void 0?i.range:0;switch(i.type){case"directional":A=new os(h),A.target.position.set(0,0,-1),A.add(A.target);break;case"point":A=new as(h),A.distance=d;break;case"spot":A=new ss(h),A.distance=d,i.spot=i.spot||{},i.spot.innerConeAngle=i.spot.innerConeAngle!==void 0?i.spot.innerConeAngle:0,i.spot.outerConeAngle=i.spot.outerConeAngle!==void 0?i.spot.outerConeAngle:Math.PI/4,A.angle=i.spot.outerConeAngle,A.penumbra=1-i.spot.innerConeAngle/i.spot.outerConeAngle,A.target.position.set(0,0,-1),A.add(A.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+i.type)}return A.position.set(0,0,0),A.decay=2,st(A,i),i.intensity!==void 0&&(A.intensity=i.intensity),A.name=n.createUniqueName(i.name||"light_"+e),r=Promise.resolve(A),n.cache.add(t,r),r}getDependency(e,n){if(e==="light")return this._loadLight(n)}createNodeAttachment(e){const n=this,t=this.parser,s=t.json.nodes[e],c=(s.extensions&&s.extensions[this.name]||{}).light;return c===void 0?null:this._loadLight(c).then(function(i){return t._getNodeRef(n.cache,c,i)})}}class Sa{constructor(){this.name=re.KHR_MATERIALS_UNLIT}getMaterialType(){return Ot}extendParams(e,n,t){const r=[];e.color=new mt(1,1,1),e.opacity=1;const s=n.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const a=s.baseColorFactor;e.color.setRGB(a[0],a[1],a[2],ct),e.opacity=a[3]}s.baseColorTexture!==void 0&&r.push(t.assignTexture(e,"map",s.baseColorTexture,Rt))}return Promise.all(r)}}class Ha{constructor(e){this.parser=e,this.name=re.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,n){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return s!==void 0&&(n.emissiveIntensity=s),Promise.resolve()}}class _a{constructor(e){this.parser=e,this.name=re.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:tt}extendMaterialParams(e,n){const t=this.parser,r=t.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];if(a.clearcoatFactor!==void 0&&(n.clearcoat=a.clearcoatFactor),a.clearcoatTexture!==void 0&&s.push(t.assignTexture(n,"clearcoatMap",a.clearcoatTexture)),a.clearcoatRoughnessFactor!==void 0&&(n.clearcoatRoughness=a.clearcoatRoughnessFactor),a.clearcoatRoughnessTexture!==void 0&&s.push(t.assignTexture(n,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),a.clearcoatNormalTexture!==void 0&&(s.push(t.assignTexture(n,"clearcoatNormalMap",a.clearcoatNormalTexture)),a.clearcoatNormalTexture.scale!==void 0)){const c=a.clearcoatNormalTexture.scale;n.clearcoatNormalScale=new Le(c,c)}return Promise.all(s)}}class xa{constructor(e){this.parser=e,this.name=re.KHR_MATERIALS_DISPERSION}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:tt}extendMaterialParams(e,n){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return n.dispersion=s.dispersion!==void 0?s.dispersion:0,Promise.resolve()}}class La{constructor(e){this.parser=e,this.name=re.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:tt}extendMaterialParams(e,n){const t=this.parser,r=t.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return a.iridescenceFactor!==void 0&&(n.iridescence=a.iridescenceFactor),a.iridescenceTexture!==void 0&&s.push(t.assignTexture(n,"iridescenceMap",a.iridescenceTexture)),a.iridescenceIor!==void 0&&(n.iridescenceIOR=a.iridescenceIor),n.iridescenceThicknessRange===void 0&&(n.iridescenceThicknessRange=[100,400]),a.iridescenceThicknessMinimum!==void 0&&(n.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),a.iridescenceThicknessMaximum!==void 0&&(n.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),a.iridescenceThicknessTexture!==void 0&&s.push(t.assignTexture(n,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(s)}}class Oa{constructor(e){this.parser=e,this.name=re.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:tt}extendMaterialParams(e,n){const t=this.parser,r=t.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];n.sheenColor=new mt(0,0,0),n.sheenRoughness=0,n.sheen=1;const a=r.extensions[this.name];if(a.sheenColorFactor!==void 0){const c=a.sheenColorFactor;n.sheenColor.setRGB(c[0],c[1],c[2],ct)}return a.sheenRoughnessFactor!==void 0&&(n.sheenRoughness=a.sheenRoughnessFactor),a.sheenColorTexture!==void 0&&s.push(t.assignTexture(n,"sheenColorMap",a.sheenColorTexture,Rt)),a.sheenRoughnessTexture!==void 0&&s.push(t.assignTexture(n,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(s)}}class Pa{constructor(e){this.parser=e,this.name=re.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:tt}extendMaterialParams(e,n){const t=this.parser,r=t.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return a.transmissionFactor!==void 0&&(n.transmission=a.transmissionFactor),a.transmissionTexture!==void 0&&s.push(t.assignTexture(n,"transmissionMap",a.transmissionTexture)),Promise.all(s)}}class Ua{constructor(e){this.parser=e,this.name=re.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:tt}extendMaterialParams(e,n){const t=this.parser,r=t.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];n.thickness=a.thicknessFactor!==void 0?a.thicknessFactor:0,a.thicknessTexture!==void 0&&s.push(t.assignTexture(n,"thicknessMap",a.thicknessTexture)),n.attenuationDistance=a.attenuationDistance||1/0;const c=a.attenuationColor||[1,1,1];return n.attenuationColor=new mt().setRGB(c[0],c[1],c[2],ct),Promise.all(s)}}class Ja{constructor(e){this.parser=e,this.name=re.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:tt}extendMaterialParams(e,n){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return n.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class Na{constructor(e){this.parser=e,this.name=re.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:tt}extendMaterialParams(e,n){const t=this.parser,r=t.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];n.specularIntensity=a.specularFactor!==void 0?a.specularFactor:1,a.specularTexture!==void 0&&s.push(t.assignTexture(n,"specularIntensityMap",a.specularTexture));const c=a.specularColorFactor||[1,1,1];return n.specularColor=new mt().setRGB(c[0],c[1],c[2],ct),a.specularColorTexture!==void 0&&s.push(t.assignTexture(n,"specularColorMap",a.specularColorTexture,Rt)),Promise.all(s)}}class ka{constructor(e){this.parser=e,this.name=re.EXT_MATERIALS_BUMP}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:tt}extendMaterialParams(e,n){const t=this.parser,r=t.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return n.bumpScale=a.bumpFactor!==void 0?a.bumpFactor:1,a.bumpTexture!==void 0&&s.push(t.assignTexture(n,"bumpMap",a.bumpTexture)),Promise.all(s)}}class Ka{constructor(e){this.parser=e,this.name=re.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:tt}extendMaterialParams(e,n){const t=this.parser,r=t.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return a.anisotropyStrength!==void 0&&(n.anisotropy=a.anisotropyStrength),a.anisotropyRotation!==void 0&&(n.anisotropyRotation=a.anisotropyRotation),a.anisotropyTexture!==void 0&&s.push(t.assignTexture(n,"anisotropyMap",a.anisotropyTexture)),Promise.all(s)}}class Qa{constructor(e){this.parser=e,this.name=re.KHR_TEXTURE_BASISU}loadTexture(e){const n=this.parser,t=n.json,r=t.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],a=n.options.ktx2Loader;if(!a){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return n.loadTextureImage(e,s.source,a)}}class Xa{constructor(e){this.parser=e,this.name=re.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const n=this.name,t=this.parser,r=t.json,s=r.textures[e];if(!s.extensions||!s.extensions[n])return null;const a=s.extensions[n],c=r.images[a.source];let i=t.textureLoader;if(c.uri){const A=t.options.manager.getHandler(c.uri);A!==null&&(i=A)}return this.detectSupport().then(function(A){if(A)return t.loadTextureImage(e,a.source,i);if(r.extensionsRequired&&r.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return t.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class ja{constructor(e){this.parser=e,this.name=re.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const n=this.name,t=this.parser,r=t.json,s=r.textures[e];if(!s.extensions||!s.extensions[n])return null;const a=s.extensions[n],c=r.images[a.source];let i=t.textureLoader;if(c.uri){const A=t.options.manager.getHandler(c.uri);A!==null&&(i=A)}return this.detectSupport().then(function(A){if(A)return t.loadTextureImage(e,a.source,i);if(r.extensionsRequired&&r.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return t.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class Ya{constructor(e){this.name=re.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const n=this.parser.json,t=n.bufferViews[e];if(t.extensions&&t.extensions[this.name]){const r=t.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(c){const i=r.byteOffset||0,A=r.byteLength||0,h=r.count,d=r.byteStride,f=new Uint8Array(c,i,A);return a.decodeGltfBufferAsync?a.decodeGltfBufferAsync(h,d,f,r.mode,r.filter).then(function(C){return C.buffer}):a.ready.then(function(){const C=new ArrayBuffer(h*d);return a.decodeGltfBuffer(new Uint8Array(C),h,d,f,r.mode,r.filter),C})})}else return null}}class Za{constructor(e){this.name=re.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const n=this.parser.json,t=n.nodes[e];if(!t.extensions||!t.extensions[this.name]||t.mesh===void 0)return null;const r=n.meshes[t.mesh];for(const A of r.primitives)if(A.mode!==Xe.TRIANGLES&&A.mode!==Xe.TRIANGLE_STRIP&&A.mode!==Xe.TRIANGLE_FAN&&A.mode!==void 0)return null;const a=t.extensions[this.name].attributes,c=[],i={};for(const A in a)c.push(this.parser.getDependency("accessor",a[A]).then(h=>(i[A]=h,i[A])));return c.length<1?null:(c.push(this.parser.createNodeMesh(e)),Promise.all(c).then(A=>{const h=A.pop(),d=h.isGroup?h.children:[h],f=A[0].count,C=[];for(const g of d){const T=new Cn,M=new Be,I=new pn,L=new Be(1,1,1),J=new is(g.geometry,g.material,f);for(let U=0;U<f;U++)i.TRANSLATION&&M.fromBufferAttribute(i.TRANSLATION,U),i.ROTATION&&I.fromBufferAttribute(i.ROTATION,U),i.SCALE&&L.fromBufferAttribute(i.SCALE,U),J.setMatrixAt(U,T.compose(M,I,L));for(const U in i)if(U==="_COLOR_0"){const O=i[U];J.instanceColor=new cs(O.array,O.itemSize,O.normalized)}else U!=="TRANSLATION"&&U!=="ROTATION"&&U!=="SCALE"&&g.geometry.setAttribute(U,i[U]);Ir.prototype.copy.call(J,g),this.parser.assignFinalMaterial(J),C.push(J)}return h.isGroup?(h.clear(),h.add(...C),h):C[0]}))}}const Pr="glTF",Qt=12,dr={JSON:1313821514,BIN:5130562};class Wa{constructor(e){this.name=re.KHR_BINARY_GLTF,this.content=null,this.body=null;const n=new DataView(e,0,Qt);if(this.header={magic:En(new Uint8Array(e.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==Pr)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const t=this.header.length-Qt,r=new DataView(e,Qt);let s=0;for(;s<t;){const a=r.getUint32(s,!0);s+=4;const c=r.getUint32(s,!0);if(s+=4,c===dr.JSON){const i=new Uint8Array(e,Qt+s,a);this.content=En(i)}else if(c===dr.BIN){const i=Qt+s;this.body=e.slice(i,i+a)}s+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Va{constructor(e,n){if(!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=re.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=n,this.dracoLoader.preload()}decodePrimitive(e,n){const t=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,c={},i={},A={};for(const h in a){const d=Qn[h]||h.toLowerCase();c[d]=a[h]}for(const h in e.attributes){const d=Qn[h]||h.toLowerCase();if(a[h]!==void 0){const f=t.accessors[e.attributes[h]],C=Ut[f.componentType];A[d]=C.name,i[d]=f.normalized===!0}}return n.getDependency("bufferView",s).then(function(h){return new Promise(function(d,f){r.decodeDracoFile(h,function(C){for(const g in C.attributes){const T=C.attributes[g],M=i[g];M!==void 0&&(T.normalized=M)}d(C)},c,A,ct,f)})})}}class za{constructor(){this.name=re.KHR_TEXTURE_TRANSFORM}extendTexture(e,n){return(n.texCoord===void 0||n.texCoord===e.channel)&&n.offset===void 0&&n.rotation===void 0&&n.scale===void 0||(e=e.clone(),n.texCoord!==void 0&&(e.channel=n.texCoord),n.offset!==void 0&&e.offset.fromArray(n.offset),n.rotation!==void 0&&(e.rotation=n.rotation),n.scale!==void 0&&e.repeat.fromArray(n.scale),e.needsUpdate=!0),e}}class qa{constructor(){this.name=re.KHR_MESH_QUANTIZATION}}class Ur extends Hs{constructor(e,n,t,r){super(e,n,t,r)}copySampleValue_(e){const n=this.resultBuffer,t=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let a=0;a!==r;a++)n[a]=t[s+a];return n}interpolate_(e,n,t,r){const s=this.resultBuffer,a=this.sampleValues,c=this.valueSize,i=c*2,A=c*3,h=r-n,d=(t-n)/h,f=d*d,C=f*d,g=e*A,T=g-A,M=-2*C+3*f,I=C-f,L=1-M,J=I-f+d;for(let U=0;U!==c;U++){const O=a[T+U+c],D=a[T+U+i]*h,Y=a[g+U+c],b=a[g+U]*h;s[U]=L*O+J*D+M*Y+I*b}return s}}const $a=new pn;class eo extends Ur{interpolate_(e,n,t,r){const s=super.interpolate_(e,n,t,r);return $a.fromArray(s).normalize().toArray(s),s}}const Xe={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Ut={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},fr={9728:Is,9729:Ye,9984:Fs,9985:Ts,9986:bs,9987:Fr},Br={33071:at,33648:Rs,10497:Pn},wn={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Qn={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...la>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ht={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},to={CUBICSPLINE:void 0,LINEAR:Rr,STEP:Ds},Sn={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function no(l){return l.DefaultMaterial===void 0&&(l.DefaultMaterial=new Tr({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:ys})),l.DefaultMaterial}function Tt(l,e,n){for(const t in n.extensions)l[t]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[t]=n.extensions[t])}function st(l,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(l.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function ro(l,e,n){let t=!1,r=!1,s=!1;for(let A=0,h=e.length;A<h;A++){const d=e[A];if(d.POSITION!==void 0&&(t=!0),d.NORMAL!==void 0&&(r=!0),d.COLOR_0!==void 0&&(s=!0),t&&r&&s)break}if(!t&&!r&&!s)return Promise.resolve(l);const a=[],c=[],i=[];for(let A=0,h=e.length;A<h;A++){const d=e[A];if(t){const f=d.POSITION!==void 0?n.getDependency("accessor",d.POSITION):l.attributes.position;a.push(f)}if(r){const f=d.NORMAL!==void 0?n.getDependency("accessor",d.NORMAL):l.attributes.normal;c.push(f)}if(s){const f=d.COLOR_0!==void 0?n.getDependency("accessor",d.COLOR_0):l.attributes.color;i.push(f)}}return Promise.all([Promise.all(a),Promise.all(c),Promise.all(i)]).then(function(A){const h=A[0],d=A[1],f=A[2];return t&&(l.morphAttributes.position=h),r&&(l.morphAttributes.normal=d),s&&(l.morphAttributes.color=f),l.morphTargetsRelative=!0,l})}function so(l,e){if(l.updateMorphTargets(),e.weights!==void 0)for(let n=0,t=e.weights.length;n<t;n++)l.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){const n=e.extras.targetNames;if(l.morphTargetInfluences.length===n.length){l.morphTargetDictionary={};for(let t=0,r=n.length;t<r;t++)l.morphTargetDictionary[n[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function ao(l){let e;const n=l.extensions&&l.extensions[re.KHR_DRACO_MESH_COMPRESSION];if(n?e="draco:"+n.bufferView+":"+n.indices+":"+Hn(n.attributes):e=l.indices+":"+Hn(l.attributes)+":"+l.mode,l.targets!==void 0)for(let t=0,r=l.targets.length;t<r;t++)e+=":"+Hn(l.targets[t]);return e}function Hn(l){let e="";const n=Object.keys(l).sort();for(let t=0,r=n.length;t<r;t++)e+=n[t]+":"+l[n[t]]+";";return e}function Xn(l){switch(l){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function oo(l){return l.search(/\.jpe?g($|\?)/i)>0||l.search(/^data\:image\/jpeg/)===0?"image/jpeg":l.search(/\.webp($|\?)/i)>0||l.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const io=new Cn;class co{constructor(e={},n={}){this.json=e,this.extensions={},this.plugins={},this.options=n,this.cache=new Ga,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let t=!1,r=!1,s=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(t=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||t||r&&s<98?this.textureLoader=new ls(this.options.manager):this.textureLoader=new us(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Bt(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,n){const t=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(a){return a._markDefs&&a._markDefs()}),Promise.all(this._invokeAll(function(a){return a.beforeRoot&&a.beforeRoot()})).then(function(){return Promise.all([t.getDependencies("scene"),t.getDependencies("animation"),t.getDependencies("camera")])}).then(function(a){const c={scene:a[0][r.scene||0],scenes:a[0],animations:a[1],cameras:a[2],asset:r.asset,parser:t,userData:{}};return Tt(s,c,r),st(c,r),Promise.all(t._invokeAll(function(i){return i.afterRoot&&i.afterRoot(c)})).then(function(){for(const i of c.scenes)i.updateMatrixWorld();e(c)})}).catch(n)}_markDefs(){const e=this.json.nodes||[],n=this.json.skins||[],t=this.json.meshes||[];for(let r=0,s=n.length;r<s;r++){const a=n[r].joints;for(let c=0,i=a.length;c<i;c++)e[a[c]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const a=e[r];a.mesh!==void 0&&(this._addNodeRef(this.meshCache,a.mesh),a.skin!==void 0&&(t[a.mesh].isSkinnedMesh=!0)),a.camera!==void 0&&this._addNodeRef(this.cameraCache,a.camera)}}_addNodeRef(e,n){n!==void 0&&(e.refs[n]===void 0&&(e.refs[n]=e.uses[n]=0),e.refs[n]++)}_getNodeRef(e,n,t){if(e.refs[n]<=1)return t;const r=t.clone(),s=(a,c)=>{const i=this.associations.get(a);i!=null&&this.associations.set(c,i);for(const[A,h]of a.children.entries())s(h,c.children[A])};return s(t,r),r.name+="_instance_"+e.uses[n]++,r}_invokeOne(e){const n=Object.values(this.plugins);n.push(this);for(let t=0;t<n.length;t++){const r=e(n[t]);if(r)return r}return null}_invokeAll(e){const n=Object.values(this.plugins);n.unshift(this);const t=[];for(let r=0;r<n.length;r++){const s=e(n[r]);s&&t.push(s)}return t}getDependency(e,n){const t=e+":"+n;let r=this.cache.get(t);if(!r){switch(e){case"scene":r=this.loadScene(n);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(n)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(n)});break;case"accessor":r=this.loadAccessor(n);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(n)});break;case"buffer":r=this.loadBuffer(n);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(n)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(n)});break;case"skin":r=this.loadSkin(n);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(n)});break;case"camera":r=this.loadCamera(n);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,n)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(t,r)}return r}getDependencies(e){let n=this.cache.get(e);if(!n){const t=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];n=Promise.all(r.map(function(s,a){return t.getDependency(e,a)})),this.cache.add(e,n)}return n}loadBuffer(e){const n=this.json.buffers[e],t=this.fileLoader;if(n.type&&n.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+n.type+" buffer type is not supported.");if(n.uri===void 0&&e===0)return Promise.resolve(this.extensions[re.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,a){t.load(Wt.resolveURL(n.uri,r.path),s,void 0,function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+n.uri+'".'))})})}loadBufferView(e){const n=this.json.bufferViews[e];return this.getDependency("buffer",n.buffer).then(function(t){const r=n.byteLength||0,s=n.byteOffset||0;return t.slice(s,s+r)})}loadAccessor(e){const n=this,t=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){const a=wn[r.type],c=Ut[r.componentType],i=r.normalized===!0,A=new c(r.count*a);return Promise.resolve(new Vt(A,a,i))}const s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(a){const c=a[0],i=wn[r.type],A=Ut[r.componentType],h=A.BYTES_PER_ELEMENT,d=h*i,f=r.byteOffset||0,C=r.bufferView!==void 0?t.bufferViews[r.bufferView].byteStride:void 0,g=r.normalized===!0;let T,M;if(C&&C!==d){const I=Math.floor(f/C),L="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+I+":"+r.count;let J=n.cache.get(L);J||(T=new A(c,I*C,r.count*C/h),J=new As(T,C/h),n.cache.add(L,J)),M=new Gs(J,i,f%C/h,g)}else c===null?T=new A(r.count*i):T=new A(c,f,r.count*i),M=new Vt(T,i,g);if(r.sparse!==void 0){const I=wn.SCALAR,L=Ut[r.sparse.indices.componentType],J=r.sparse.indices.byteOffset||0,U=r.sparse.values.byteOffset||0,O=new L(a[1],J,r.sparse.count*I),D=new A(a[2],U,r.sparse.count*i);c!==null&&(M=new Vt(M.array.slice(),M.itemSize,M.normalized));for(let Y=0,b=O.length;Y<b;Y++){const F=O[Y];if(M.setX(F,D[Y*i]),i>=2&&M.setY(F,D[Y*i+1]),i>=3&&M.setZ(F,D[Y*i+2]),i>=4&&M.setW(F,D[Y*i+3]),i>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return M})}loadTexture(e){const n=this.json,t=this.options,s=n.textures[e].source,a=n.images[s];let c=this.textureLoader;if(a.uri){const i=t.manager.getHandler(a.uri);i!==null&&(c=i)}return this.loadTextureImage(e,s,c)}loadTextureImage(e,n,t){const r=this,s=this.json,a=s.textures[e],c=s.images[n],i=(c.uri||c.bufferView)+":"+a.sampler;if(this.textureCache[i])return this.textureCache[i];const A=this.loadImageSource(n,t).then(function(h){h.flipY=!1,h.name=a.name||c.name||"",h.name===""&&typeof c.uri=="string"&&c.uri.startsWith("data:image/")===!1&&(h.name=c.uri);const f=(s.samplers||{})[a.sampler]||{};return h.magFilter=fr[f.magFilter]||Ye,h.minFilter=fr[f.minFilter]||Fr,h.wrapS=Br[f.wrapS]||Pn,h.wrapT=Br[f.wrapT]||Pn,r.associations.set(h,{textures:e}),h}).catch(function(){return null});return this.textureCache[i]=A,A}loadImageSource(e,n){const t=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(d=>d.clone());const a=r.images[e],c=self.URL||self.webkitURL;let i=a.uri||"",A=!1;if(a.bufferView!==void 0)i=t.getDependency("bufferView",a.bufferView).then(function(d){A=!0;const f=new Blob([d],{type:a.mimeType});return i=c.createObjectURL(f),i});else if(a.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(i).then(function(d){return new Promise(function(f,C){let g=f;n.isImageBitmapLoader===!0&&(g=function(T){const M=new ot(T);M.needsUpdate=!0,f(M)}),n.load(Wt.resolveURL(d,s.path),g,void 0,C)})}).then(function(d){return A===!0&&c.revokeObjectURL(i),st(d,a),d.userData.mimeType=a.mimeType||oo(a.uri),d}).catch(function(d){throw console.error("THREE.GLTFLoader: Couldn't load texture",i),d});return this.sourceCache[e]=h,h}assignTexture(e,n,t,r){const s=this;return this.getDependency("texture",t.index).then(function(a){if(!a)return null;if(t.texCoord!==void 0&&t.texCoord>0&&(a=a.clone(),a.channel=t.texCoord),s.extensions[re.KHR_TEXTURE_TRANSFORM]){const c=t.extensions!==void 0?t.extensions[re.KHR_TEXTURE_TRANSFORM]:void 0;if(c){const i=s.associations.get(a);a=s.extensions[re.KHR_TEXTURE_TRANSFORM].extendTexture(a,c),s.associations.set(a,i)}}return r!==void 0&&(typeof r=="number"&&(r=r===hr?Rt:ct),"colorSpace"in a?a.colorSpace=r:a.encoding=r===Rt?hr:ya),e[n]=a,a})}assignFinalMaterial(e){const n=e.geometry;let t=e.material;const r=n.attributes.tangent===void 0,s=n.attributes.color!==void 0,a=n.attributes.normal===void 0;if(e.isPoints){const c="PointsMaterial:"+t.uuid;let i=this.cache.get(c);i||(i=new hs,Rn.prototype.copy.call(i,t),i.color.copy(t.color),i.map=t.map,i.sizeAttenuation=!1,this.cache.add(c,i)),t=i}else if(e.isLine){const c="LineBasicMaterial:"+t.uuid;let i=this.cache.get(c);i||(i=new ds,Rn.prototype.copy.call(i,t),i.color.copy(t.color),i.map=t.map,this.cache.add(c,i)),t=i}if(r||s||a){let c="ClonedMaterial:"+t.uuid+":";r&&(c+="derivative-tangents:"),s&&(c+="vertex-colors:"),a&&(c+="flat-shading:");let i=this.cache.get(c);i||(i=t.clone(),s&&(i.vertexColors=!0),a&&(i.flatShading=!0),r&&(i.normalScale&&(i.normalScale.y*=-1),i.clearcoatNormalScale&&(i.clearcoatNormalScale.y*=-1)),this.cache.add(c,i),this.associations.set(i,this.associations.get(t))),t=i}e.material=t}getMaterialType(){return Tr}loadMaterial(e){const n=this,t=this.json,r=this.extensions,s=t.materials[e];let a;const c={},i=s.extensions||{},A=[];if(i[re.KHR_MATERIALS_UNLIT]){const d=r[re.KHR_MATERIALS_UNLIT];a=d.getMaterialType(),A.push(d.extendParams(c,s,n))}else{const d=s.pbrMetallicRoughness||{};if(c.color=new mt(1,1,1),c.opacity=1,Array.isArray(d.baseColorFactor)){const f=d.baseColorFactor;c.color.setRGB(f[0],f[1],f[2],ct),c.opacity=f[3]}d.baseColorTexture!==void 0&&A.push(n.assignTexture(c,"map",d.baseColorTexture,Rt)),c.metalness=d.metallicFactor!==void 0?d.metallicFactor:1,c.roughness=d.roughnessFactor!==void 0?d.roughnessFactor:1,d.metallicRoughnessTexture!==void 0&&(A.push(n.assignTexture(c,"metalnessMap",d.metallicRoughnessTexture)),A.push(n.assignTexture(c,"roughnessMap",d.metallicRoughnessTexture))),a=this._invokeOne(function(f){return f.getMaterialType&&f.getMaterialType(e)}),A.push(Promise.all(this._invokeAll(function(f){return f.extendMaterialParams&&f.extendMaterialParams(e,c)})))}s.doubleSided===!0&&(c.side=jn);const h=s.alphaMode||Sn.OPAQUE;if(h===Sn.BLEND?(c.transparent=!0,c.depthWrite=!1):(c.transparent=!1,h===Sn.MASK&&(c.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&a!==Ot&&(A.push(n.assignTexture(c,"normalMap",s.normalTexture)),c.normalScale=new Le(1,1),s.normalTexture.scale!==void 0)){const d=s.normalTexture.scale;c.normalScale.set(d,d)}if(s.occlusionTexture!==void 0&&a!==Ot&&(A.push(n.assignTexture(c,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(c.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&a!==Ot){const d=s.emissiveFactor;c.emissive=new mt().setRGB(d[0],d[1],d[2],ct)}return s.emissiveTexture!==void 0&&a!==Ot&&A.push(n.assignTexture(c,"emissiveMap",s.emissiveTexture,Rt)),Promise.all(A).then(function(){const d=new a(c);return s.name&&(d.name=s.name),st(d,s),n.associations.set(d,{materials:e}),s.extensions&&Tt(r,d,s),d})}createUniqueName(e){const n=fs.sanitizeNodeName(e||"");return n in this.nodeNamesUsed?n+"_"+ ++this.nodeNamesUsed[n]:(this.nodeNamesUsed[n]=0,n)}loadGeometries(e){const n=this,t=this.extensions,r=this.primitiveCache;function s(c){return t[re.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(c,n).then(function(i){return mr(i,c,n)})}const a=[];for(let c=0,i=e.length;c<i;c++){const A=e[c],h=ao(A),d=r[h];if(d)a.push(d.promise);else{let f;A.extensions&&A.extensions[re.KHR_DRACO_MESH_COMPRESSION]?f=s(A):f=mr(new br,A,n),r[h]={primitive:A,promise:f},a.push(f)}}return Promise.all(a)}loadMesh(e){const n=this,t=this.json,r=this.extensions,s=t.meshes[e],a=s.primitives,c=[];for(let i=0,A=a.length;i<A;i++){const h=a[i].material===void 0?no(this.cache):this.getDependency("material",a[i].material);c.push(h)}return c.push(n.loadGeometries(a)),Promise.all(c).then(function(i){const A=i.slice(0,i.length-1),h=i[i.length-1],d=[];for(let C=0,g=h.length;C<g;C++){const T=h[C],M=a[C];let I;const L=A[C];if(M.mode===Xe.TRIANGLES||M.mode===Xe.TRIANGLE_STRIP||M.mode===Xe.TRIANGLE_FAN||M.mode===void 0)I=s.isSkinnedMesh===!0?new Bs(T,L):new rn(T,L),I.isSkinnedMesh===!0&&I.normalizeSkinWeights(),M.mode===Xe.TRIANGLE_STRIP?I.geometry=lr(I.geometry,Mr):M.mode===Xe.TRIANGLE_FAN&&(I.geometry=lr(I.geometry,On));else if(M.mode===Xe.LINES)I=new ms(T,L);else if(M.mode===Xe.LINE_STRIP)I=new ps(T,L);else if(M.mode===Xe.LINE_LOOP)I=new Cs(T,L);else if(M.mode===Xe.POINTS)I=new gs(T,L);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+M.mode);Object.keys(I.geometry.morphAttributes).length>0&&so(I,s),I.name=n.createUniqueName(s.name||"mesh_"+e),st(I,s),M.extensions&&Tt(r,I,M),n.assignFinalMaterial(I),d.push(I)}for(let C=0,g=d.length;C<g;C++)n.associations.set(d[C],{meshes:e,primitives:C});if(d.length===1)return s.extensions&&Tt(r,d[0],s),d[0];const f=new Dn;s.extensions&&Tt(r,f,s),n.associations.set(f,{meshes:e});for(let C=0,g=d.length;C<g;C++)f.add(d[C]);return f})}loadCamera(e){let n;const t=this.json.cameras[e],r=t[t.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return t.type==="perspective"?n=new bt(Yt.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):t.type==="orthographic"&&(n=new dt(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),t.name&&(n.name=this.createUniqueName(t.name)),st(n,t),Promise.resolve(n)}loadSkin(e){const n=this.json.skins[e],t=[];for(let r=0,s=n.joints.length;r<s;r++)t.push(this._loadNodeShallow(n.joints[r]));return n.inverseBindMatrices!==void 0?t.push(this.getDependency("accessor",n.inverseBindMatrices)):t.push(null),Promise.all(t).then(function(r){const s=r.pop(),a=r,c=[],i=[];for(let A=0,h=a.length;A<h;A++){const d=a[A];if(d){c.push(d);const f=new Cn;s!==null&&f.fromArray(s.array,A*16),i.push(f)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',n.joints[A])}return new vs(c,i)})}loadAnimation(e){const n=this.json,t=this,r=n.animations[e],s=r.name?r.name:"animation_"+e,a=[],c=[],i=[],A=[],h=[];for(let d=0,f=r.channels.length;d<f;d++){const C=r.channels[d],g=r.samplers[C.sampler],T=C.target,M=T.node,I=r.parameters!==void 0?r.parameters[g.input]:g.input,L=r.parameters!==void 0?r.parameters[g.output]:g.output;T.node!==void 0&&(a.push(this.getDependency("node",M)),c.push(this.getDependency("accessor",I)),i.push(this.getDependency("accessor",L)),A.push(g),h.push(T))}return Promise.all([Promise.all(a),Promise.all(c),Promise.all(i),Promise.all(A),Promise.all(h)]).then(function(d){const f=d[0],C=d[1],g=d[2],T=d[3],M=d[4],I=[];for(let L=0,J=f.length;L<J;L++){const U=f[L],O=C[L],D=g[L],Y=T[L],b=M[L];if(U===void 0)continue;U.updateMatrix&&U.updateMatrix();const F=t._createAnimationTracks(U,O,D,Y,b);if(F)for(let P=0;P<F.length;P++)I.push(F[P])}return new Es(s,void 0,I)})}createNodeMesh(e){const n=this.json,t=this,r=n.nodes[e];return r.mesh===void 0?null:t.getDependency("mesh",r.mesh).then(function(s){const a=t._getNodeRef(t.meshCache,r.mesh,s);return r.weights!==void 0&&a.traverse(function(c){if(c.isMesh)for(let i=0,A=r.weights.length;i<A;i++)c.morphTargetInfluences[i]=r.weights[i]}),a})}loadNode(e){const n=this.json,t=this,r=n.nodes[e],s=t._loadNodeShallow(e),a=[],c=r.children||[];for(let A=0,h=c.length;A<h;A++)a.push(t.getDependency("node",c[A]));const i=r.skin===void 0?Promise.resolve(null):t.getDependency("skin",r.skin);return Promise.all([s,Promise.all(a),i]).then(function(A){const h=A[0],d=A[1],f=A[2];f!==null&&h.traverse(function(C){C.isSkinnedMesh&&C.bind(f,io)});for(let C=0,g=d.length;C<g;C++)h.add(d[C]);return h})}_loadNodeShallow(e){const n=this.json,t=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=n.nodes[e],a=s.name?r.createUniqueName(s.name):"",c=[],i=r._invokeOne(function(A){return A.createNodeMesh&&A.createNodeMesh(e)});return i&&c.push(i),s.camera!==void 0&&c.push(r.getDependency("camera",s.camera).then(function(A){return r._getNodeRef(r.cameraCache,s.camera,A)})),r._invokeAll(function(A){return A.createNodeAttachment&&A.createNodeAttachment(e)}).forEach(function(A){c.push(A)}),this.nodeCache[e]=Promise.all(c).then(function(A){let h;if(s.isBone===!0?h=new Ms:A.length>1?h=new Dn:A.length===1?h=A[0]:h=new Ir,h!==A[0])for(let d=0,f=A.length;d<f;d++)h.add(A[d]);if(s.name&&(h.userData.name=s.name,h.name=a),st(h,s),s.extensions&&Tt(t,h,s),s.matrix!==void 0){const d=new Cn;d.fromArray(s.matrix),h.applyMatrix4(d)}else s.translation!==void 0&&h.position.fromArray(s.translation),s.rotation!==void 0&&h.quaternion.fromArray(s.rotation),s.scale!==void 0&&h.scale.fromArray(s.scale);return r.associations.has(h)||r.associations.set(h,{}),r.associations.get(h).nodes=e,h}),this.nodeCache[e]}loadScene(e){const n=this.extensions,t=this.json.scenes[e],r=this,s=new Dn;t.name&&(s.name=r.createUniqueName(t.name)),st(s,t),t.extensions&&Tt(n,s,t);const a=t.nodes||[],c=[];for(let i=0,A=a.length;i<A;i++)c.push(r.getDependency("node",a[i]));return Promise.all(c).then(function(i){for(let h=0,d=i.length;h<d;h++)s.add(i[h]);const A=h=>{const d=new Map;for(const[f,C]of r.associations)(f instanceof Rn||f instanceof ot)&&d.set(f,C);return h.traverse(f=>{const C=r.associations.get(f);C!=null&&d.set(f,C)}),d};return r.associations=A(s),s})}_createAnimationTracks(e,n,t,r,s){const a=[],c=e.name?e.name:e.uuid,i=[];ht[s.path]===ht.weights?e.traverse(function(f){f.morphTargetInfluences&&i.push(f.name?f.name:f.uuid)}):i.push(c);let A;switch(ht[s.path]){case ht.weights:A=sr;break;case ht.rotation:A=ar;break;case ht.position:case ht.scale:A=rr;break;default:switch(t.itemSize){case 1:A=sr;break;case 2:case 3:default:A=rr;break}break}const h=r.interpolation!==void 0?to[r.interpolation]:Rr,d=this._getArrayFromAccessor(t);for(let f=0,C=i.length;f<C;f++){const g=new A(i[f]+"."+ht[s.path],n.array,d,h);r.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(g),a.push(g)}return a}_getArrayFromAccessor(e){let n=e.array;if(e.normalized){const t=Xn(n.constructor),r=new Float32Array(n.length);for(let s=0,a=n.length;s<a;s++)r[s]=n[s]*t;n=r}return n}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(t){const r=this instanceof ar?eo:Ur;return new r(this.times,this.values,this.getValueSize()/3,t)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function lo(l,e,n){const t=e.attributes,r=new ws;if(t.POSITION!==void 0){const c=n.json.accessors[t.POSITION],i=c.min,A=c.max;if(i!==void 0&&A!==void 0){if(r.set(new Be(i[0],i[1],i[2]),new Be(A[0],A[1],A[2])),c.normalized){const h=Xn(Ut[c.componentType]);r.min.multiplyScalar(h),r.max.multiplyScalar(h)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const c=new Be,i=new Be;for(let A=0,h=s.length;A<h;A++){const d=s[A];if(d.POSITION!==void 0){const f=n.json.accessors[d.POSITION],C=f.min,g=f.max;if(C!==void 0&&g!==void 0){if(i.setX(Math.max(Math.abs(C[0]),Math.abs(g[0]))),i.setY(Math.max(Math.abs(C[1]),Math.abs(g[1]))),i.setZ(Math.max(Math.abs(C[2]),Math.abs(g[2]))),f.normalized){const T=Xn(Ut[f.componentType]);i.multiplyScalar(T)}c.max(i)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(c)}l.boundingBox=r;const a=new Ss;r.getCenter(a.center),a.radius=r.min.distanceTo(r.max)/2,l.boundingSphere=a}function mr(l,e,n){const t=e.attributes,r=[];function s(a,c){return n.getDependency("accessor",a).then(function(i){l.setAttribute(c,i)})}for(const a in t){const c=Qn[a]||a.toLowerCase();c in l.attributes||r.push(s(t[a],c))}if(e.indices!==void 0&&!l.index){const a=n.getDependency("accessor",e.indices).then(function(c){l.setIndex(c)});r.push(a)}return st(l,e),lo(l,e,n),Promise.all(r).then(function(){return e.targets!==void 0?ro(l,e.targets,n):l})}const uo={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:`
      varying vec2 vUv;

      void main() {

        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

      }
  `,fragmentShader:`
    uniform sampler2D tDiffuse;
    uniform float h;

    varying vec2 vUv;

    void main() {

    	vec4 sum = vec4( 0.0 );

    	sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;

    	gl_FragColor = sum;

    }
  `},Ao={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:`
    varying vec2 vUv;

    void main() {

      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }
  `,fragmentShader:`

  uniform sampler2D tDiffuse;
  uniform float v;

  varying vec2 vUv;

  void main() {

    vec4 sum = vec4( 0.0 );

    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;

    gl_FragColor = sum;

  }
  `};class ho extends Dr{constructor(e){super(e),this.type=Ze}parse(e){const a=function(b,F){switch(b){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(F||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(F||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(F||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(F||""))}},h=`
`,d=function(b,F,P){F=F||1024;let ee=b.pos,$=-1,k=0,z="",W=String.fromCharCode.apply(null,new Uint16Array(b.subarray(ee,ee+128)));for(;0>($=W.indexOf(h))&&k<F&&ee<b.byteLength;)z+=W,k+=W.length,ee+=128,W+=String.fromCharCode.apply(null,new Uint16Array(b.subarray(ee,ee+128)));return-1<$?(P!==!1&&(b.pos+=k+$+1),z+W.slice(0,$)):!1},f=function(b){const F=/^#\?(\S+)/,P=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,j=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,ee=/^\s*FORMAT=(\S+)\s*$/,$=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,k={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let z,W;for((b.pos>=b.byteLength||!(z=d(b)))&&a(1,"no header found"),(W=z.match(F))||a(3,"bad initial token"),k.valid|=1,k.programtype=W[1],k.string+=z+`
`;z=d(b),z!==!1;){if(k.string+=z+`
`,z.charAt(0)==="#"){k.comments+=z+`
`;continue}if((W=z.match(P))&&(k.gamma=parseFloat(W[1])),(W=z.match(j))&&(k.exposure=parseFloat(W[1])),(W=z.match(ee))&&(k.valid|=2,k.format=W[1]),(W=z.match($))&&(k.valid|=4,k.height=parseInt(W[1],10),k.width=parseInt(W[2],10)),k.valid&2&&k.valid&4)break}return k.valid&2||a(3,"missing format specifier"),k.valid&4||a(3,"missing image size specifier"),k},C=function(b,F,P){const j=F;if(j<8||j>32767||b[0]!==2||b[1]!==2||b[2]&128)return new Uint8Array(b);j!==(b[2]<<8|b[3])&&a(3,"wrong scanline width");const ee=new Uint8Array(4*F*P);ee.length||a(4,"unable to allocate buffer space");let $=0,k=0;const z=4*j,W=new Uint8Array(4),ce=new Uint8Array(z);let Ee=P;for(;Ee>0&&k<b.byteLength;){k+4>b.byteLength&&a(1),W[0]=b[k++],W[1]=b[k++],W[2]=b[k++],W[3]=b[k++],(W[0]!=2||W[1]!=2||(W[2]<<8|W[3])!=j)&&a(3,"bad rgbe scanline format");let ge=0,ne;for(;ge<z&&k<b.byteLength;){ne=b[k++];const se=ne>128;if(se&&(ne-=128),(ne===0||ge+ne>z)&&a(3,"bad scanline data"),se){const le=b[k++];for(let ye=0;ye<ne;ye++)ce[ge++]=le}else ce.set(b.subarray(k,k+ne),ge),ge+=ne,k+=ne}const Me=j;for(let se=0;se<Me;se++){let le=0;ee[$]=ce[se+le],le+=j,ee[$+1]=ce[se+le],le+=j,ee[$+2]=ce[se+le],le+=j,ee[$+3]=ce[se+le],$+=4}Ee--}return ee},g=function(b,F,P,j){const ee=b[F+3],$=Math.pow(2,ee-128)/255;P[j+0]=b[F+0]*$,P[j+1]=b[F+1]*$,P[j+2]=b[F+2]*$,P[j+3]=1},T=function(b,F,P,j){const ee=b[F+3],$=Math.pow(2,ee-128)/255;P[j+0]=Pt.toHalfFloat(Math.min(b[F+0]*$,65504)),P[j+1]=Pt.toHalfFloat(Math.min(b[F+1]*$,65504)),P[j+2]=Pt.toHalfFloat(Math.min(b[F+2]*$,65504)),P[j+3]=Pt.toHalfFloat(1)},M=new Uint8Array(e);M.pos=0;const I=f(M),L=I.width,J=I.height,U=C(M.subarray(M.pos),L,J);let O,D,Y;switch(this.type){case it:Y=U.length/4;const b=new Float32Array(Y*4);for(let P=0;P<Y;P++)g(U,P*4,b,P*4);O=b,D=it;break;case Ze:Y=U.length/4;const F=new Uint16Array(Y*4);for(let P=0;P<Y;P++)T(U,P*4,F,P*4);O=F,D=Ze;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:L,height:J,data:O,header:I.string,gamma:I.gamma,exposure:I.exposure,type:D}}setDataType(e){return this.type=e,this}load(e,n,t,r){function s(a,c){switch(a.type){case it:case Ze:"colorSpace"in a?a.colorSpace="srgb-linear":a.encoding=3e3,a.minFilter=Ye,a.magFilter=Ye,a.generateMipmaps=!1,a.flipY=!0;break}n&&n(a,c)}return super.load(e,s,t,r)}}const Xt="colorSpace"in new ot;class fo extends Dr{constructor(e){super(e),this.type=Ze}parse(e){const F=Math.pow(2.7182818,2.2);function P(o,u){for(var B=0,p=0;p<65536;++p)(p==0||o[p>>3]&1<<(p&7))&&(u[B++]=p);for(var v=B-1;B<65536;)u[B++]=0;return v}function j(o){for(var u=0;u<16384;u++)o[u]={},o[u].len=0,o[u].lit=0,o[u].p=null}const ee={l:0,c:0,lc:0};function $(o,u,B,p,v){for(;B<o;)u=u<<8|m(p,v),B+=8;B-=o,ee.l=u>>B&(1<<o)-1,ee.c=u,ee.lc=B}const k=new Array(59);function z(o){for(var u=0;u<=58;++u)k[u]=0;for(var u=0;u<65537;++u)k[o[u]]+=1;for(var B=0,u=58;u>0;--u){var p=B+k[u]>>1;k[u]=B,B=p}for(var u=0;u<65537;++u){var v=o[u];v>0&&(o[u]=v|k[v]++<<6)}}function W(o,u,B,p,v,E,y){for(var R=B,H=0,S=0;v<=E;v++){if(R.value-B.value>p)return!1;$(6,H,S,o,R);var _=ee.l;if(H=ee.c,S=ee.lc,y[v]=_,_==63){if(R.value-B.value>p)throw"Something wrong with hufUnpackEncTable";$(8,H,S,o,R);var w=ee.l+6;if(H=ee.c,S=ee.lc,v+w>E+1)throw"Something wrong with hufUnpackEncTable";for(;w--;)y[v++]=0;v--}else if(_>=59){var w=_-59+2;if(v+w>E+1)throw"Something wrong with hufUnpackEncTable";for(;w--;)y[v++]=0;v--}}z(y)}function ce(o){return o&63}function Ee(o){return o>>6}function ge(o,u,B,p){for(;u<=B;u++){var v=Ee(o[u]),E=ce(o[u]);if(v>>E)throw"Invalid table entry";if(E>14){var y=p[v>>E-14];if(y.len)throw"Invalid table entry";if(y.lit++,y.p){var R=y.p;y.p=new Array(y.lit);for(var H=0;H<y.lit-1;++H)y.p[H]=R[H]}else y.p=new Array(1);y.p[y.lit-1]=u}else if(E)for(var S=0,H=1<<14-E;H>0;H--){var y=p[(v<<14-E)+S];if(y.len||y.p)throw"Invalid table entry";y.len=E,y.lit=u,S++}}return!0}const ne={c:0,lc:0};function Me(o,u,B,p){o=o<<8|m(B,p),u+=8,ne.c=o,ne.lc=u}const se={c:0,lc:0};function le(o,u,B,p,v,E,y,R,H,S){if(o==u){p<8&&(Me(B,p,v,y),B=ne.c,p=ne.lc),p-=8;var _=B>>p,_=new Uint8Array([_])[0];if(H.value+_>S)return!1;for(var w=R[H.value-1];_-- >0;)R[H.value++]=w}else if(H.value<S)R[H.value++]=o;else return!1;se.c=B,se.lc=p}function ye(o){return o&65535}function Oe(o){var u=ye(o);return u>32767?u-65536:u}const oe={a:0,b:0};function Pe(o,u){var B=Oe(o),p=Oe(u),v=p,E=B+(v&1)+(v>>1),y=E,R=E-v;oe.a=y,oe.b=R}function be(o,u){var B=ye(o),p=ye(u),v=B-(p>>1)&65535,E=p+v-32768&65535;oe.a=E,oe.b=v}function Dt(o,u,B,p,v,E,y){for(var R=y<16384,H=B>v?v:B,S=1,_;S<=H;)S<<=1;for(S>>=1,_=S,S>>=1;S>=1;){for(var w=0,ve=w+E*(v-_),Q=E*S,X=E*_,q=p*S,te=p*_,Ae,de,Te,_e;w<=ve;w+=X){for(var fe=w,et=w+p*(B-_);fe<=et;fe+=te){var me=fe+q,De=fe+Q,rt=De+q;R?(Pe(o[fe+u],o[De+u]),Ae=oe.a,Te=oe.b,Pe(o[me+u],o[rt+u]),de=oe.a,_e=oe.b,Pe(Ae,de),o[fe+u]=oe.a,o[me+u]=oe.b,Pe(Te,_e),o[De+u]=oe.a,o[rt+u]=oe.b):(be(o[fe+u],o[De+u]),Ae=oe.a,Te=oe.b,be(o[me+u],o[rt+u]),de=oe.a,_e=oe.b,be(Ae,de),o[fe+u]=oe.a,o[me+u]=oe.b,be(Te,_e),o[De+u]=oe.a,o[rt+u]=oe.b)}if(B&S){var De=fe+Q;R?Pe(o[fe+u],o[De+u]):be(o[fe+u],o[De+u]),Ae=oe.a,o[De+u]=oe.b,o[fe+u]=Ae}}if(v&S)for(var fe=w,et=w+p*(B-_);fe<=et;fe+=te){var me=fe+q;R?Pe(o[fe+u],o[me+u]):be(o[fe+u],o[me+u]),Ae=oe.a,o[me+u]=oe.b,o[fe+u]=Ae}_=S,S>>=1}return w}function Ge(o,u,B,p,v,E,y,R,H,S){for(var _=0,w=0,ve=R,Q=Math.trunc(v.value+(E+7)/8);v.value<Q;)for(Me(_,w,B,v),_=ne.c,w=ne.lc;w>=14;){var X=_>>w-14&16383,q=u[X];if(q.len)w-=q.len,le(q.lit,y,_,w,B,p,v,H,S,ve),_=se.c,w=se.lc;else{if(!q.p)throw"hufDecode issues";var te;for(te=0;te<q.lit;te++){for(var Ae=ce(o[q.p[te]]);w<Ae&&v.value<Q;)Me(_,w,B,v),_=ne.c,w=ne.lc;if(w>=Ae&&Ee(o[q.p[te]])==(_>>w-Ae&(1<<Ae)-1)){w-=Ae,le(q.p[te],y,_,w,B,p,v,H,S,ve),_=se.c,w=se.lc;break}}if(te==q.lit)throw"hufDecode issues"}}var de=8-E&7;for(_>>=de,w-=de;w>0;){var q=u[_<<14-w&16383];if(q.len)w-=q.len,le(q.lit,y,_,w,B,p,v,H,S,ve),_=se.c,w=se.lc;else throw"hufDecode issues"}return!0}function ie(o,u,B,p,v,E){var y={value:0},R=B.value,H=Re(u,B),S=Re(u,B);B.value+=4;var _=Re(u,B);if(B.value+=4,H<0||H>=65537||S<0||S>=65537)throw"Something wrong with HUF_ENCSIZE";var w=new Array(65537),ve=new Array(16384);j(ve);var Q=p-(B.value-R);if(W(o,u,B,Q,H,S,w),_>8*(p-(B.value-R)))throw"Something wrong with hufUncompress";ge(w,H,S,ve),Ge(w,ve,o,u,B,_,S,E,v,y)}function Ne(o,u,B){for(var p=0;p<B;++p)u[p]=o[u[p]]}function He(o){for(var u=1;u<o.length;u++){var B=o[u-1]+o[u]-128;o[u]=B}}function qe(o,u){for(var B=0,p=Math.floor((o.length+1)/2),v=0,E=o.length-1;!(v>E||(u[v++]=o[B++],v>E));)u[v++]=o[p++]}function nt(o){for(var u=o.byteLength,B=new Array,p=0,v=new DataView(o);u>0;){var E=v.getInt8(p++);if(E<0){var y=-E;u-=y+1;for(var R=0;R<y;R++)B.push(v.getUint8(p++))}else{var y=E;u-=2;for(var H=v.getUint8(p++),R=0;R<y+1;R++)B.push(H)}}return B}function yt(o,u,B,p,v,E){var me=new DataView(E.buffer),y=B[o.idx[0]].width,R=B[o.idx[0]].height,H=3,S=Math.floor(y/8),_=Math.ceil(y/8),w=Math.ceil(R/8),ve=y-(_-1)*8,Q=R-(w-1)*8,X={value:0},q=new Array(H),te=new Array(H),Ae=new Array(H),de=new Array(H),Te=new Array(H);for(let he=0;he<H;++he)Te[he]=u[o.idx[he]],q[he]=he<1?0:q[he-1]+_*w,te[he]=new Float32Array(64),Ae[he]=new Uint16Array(64),de[he]=new Uint16Array(_*64);for(let he=0;he<w;++he){var _e=8;he==w-1&&(_e=Q);var fe=8;for(let Ce=0;Ce<_;++Ce){Ce==_-1&&(fe=ve);for(let ue=0;ue<H;++ue)Ae[ue].fill(0),Ae[ue][0]=v[q[ue]++],ke(X,p,Ae[ue]),pt(Ae[ue],te[ue]),Ct(te[ue]);Gt(te);for(let ue=0;ue<H;++ue)wt(te[ue],de[ue],Ce*64)}let we=0;for(let Ce=0;Ce<H;++Ce){const ue=B[o.idx[Ce]].type;for(let Qe=8*he;Qe<8*he+_e;++Qe){we=Te[Ce][Qe];for(let Ft=0;Ft<S;++Ft){const Je=Ft*64+(Qe&7)*8;me.setUint16(we+0*2*ue,de[Ce][Je+0],!0),me.setUint16(we+1*2*ue,de[Ce][Je+1],!0),me.setUint16(we+2*2*ue,de[Ce][Je+2],!0),me.setUint16(we+3*2*ue,de[Ce][Je+3],!0),me.setUint16(we+4*2*ue,de[Ce][Je+4],!0),me.setUint16(we+5*2*ue,de[Ce][Je+5],!0),me.setUint16(we+6*2*ue,de[Ce][Je+6],!0),me.setUint16(we+7*2*ue,de[Ce][Je+7],!0),we+=8*2*ue}}if(S!=_)for(let Qe=8*he;Qe<8*he+_e;++Qe){const Ft=Te[Ce][Qe]+8*S*2*ue,Je=S*64+(Qe&7)*8;for(let ut=0;ut<fe;++ut)me.setUint16(Ft+ut*2*ue,de[Ce][Je+ut],!0)}}}for(var et=new Uint16Array(y),me=new DataView(E.buffer),De=0;De<H;++De){B[o.idx[De]].decoded=!0;var rt=B[o.idx[De]].type;if(B[De].type==2)for(var Kt=0;Kt<R;++Kt){const he=Te[De][Kt];for(var Ke=0;Ke<y;++Ke)et[Ke]=me.getUint16(he+Ke*2*rt,!0);for(var Ke=0;Ke<y;++Ke)me.setFloat32(he+Ke*2*rt,x(et[Ke]),!0)}}}function ke(o,u,B){for(var p,v=1;v<64;)p=u[o.value],p==65280?v=64:p>>8==255?v+=p&255:(B[v]=p,v++),o.value++}function pt(o,u){u[0]=x(o[0]),u[1]=x(o[1]),u[2]=x(o[5]),u[3]=x(o[6]),u[4]=x(o[14]),u[5]=x(o[15]),u[6]=x(o[27]),u[7]=x(o[28]),u[8]=x(o[2]),u[9]=x(o[4]),u[10]=x(o[7]),u[11]=x(o[13]),u[12]=x(o[16]),u[13]=x(o[26]),u[14]=x(o[29]),u[15]=x(o[42]),u[16]=x(o[3]),u[17]=x(o[8]),u[18]=x(o[12]),u[19]=x(o[17]),u[20]=x(o[25]),u[21]=x(o[30]),u[22]=x(o[41]),u[23]=x(o[43]),u[24]=x(o[9]),u[25]=x(o[11]),u[26]=x(o[18]),u[27]=x(o[24]),u[28]=x(o[31]),u[29]=x(o[40]),u[30]=x(o[44]),u[31]=x(o[53]),u[32]=x(o[10]),u[33]=x(o[19]),u[34]=x(o[23]),u[35]=x(o[32]),u[36]=x(o[39]),u[37]=x(o[45]),u[38]=x(o[52]),u[39]=x(o[54]),u[40]=x(o[20]),u[41]=x(o[22]),u[42]=x(o[33]),u[43]=x(o[38]),u[44]=x(o[46]),u[45]=x(o[51]),u[46]=x(o[55]),u[47]=x(o[60]),u[48]=x(o[21]),u[49]=x(o[34]),u[50]=x(o[37]),u[51]=x(o[47]),u[52]=x(o[50]),u[53]=x(o[56]),u[54]=x(o[59]),u[55]=x(o[61]),u[56]=x(o[35]),u[57]=x(o[36]),u[58]=x(o[48]),u[59]=x(o[49]),u[60]=x(o[57]),u[61]=x(o[58]),u[62]=x(o[62]),u[63]=x(o[63])}function Ct(o){const u=.5*Math.cos(.7853975),B=.5*Math.cos(3.14159/16),p=.5*Math.cos(3.14159/8),v=.5*Math.cos(3*3.14159/16),E=.5*Math.cos(5*3.14159/16),y=.5*Math.cos(3*3.14159/8),R=.5*Math.cos(7*3.14159/16);for(var H=new Array(4),S=new Array(4),_=new Array(4),w=new Array(4),ve=0;ve<8;++ve){var Q=ve*8;H[0]=p*o[Q+2],H[1]=y*o[Q+2],H[2]=p*o[Q+6],H[3]=y*o[Q+6],S[0]=B*o[Q+1]+v*o[Q+3]+E*o[Q+5]+R*o[Q+7],S[1]=v*o[Q+1]-R*o[Q+3]-B*o[Q+5]-E*o[Q+7],S[2]=E*o[Q+1]-B*o[Q+3]+R*o[Q+5]+v*o[Q+7],S[3]=R*o[Q+1]-E*o[Q+3]+v*o[Q+5]-B*o[Q+7],_[0]=u*(o[Q+0]+o[Q+4]),_[3]=u*(o[Q+0]-o[Q+4]),_[1]=H[0]+H[3],_[2]=H[1]-H[2],w[0]=_[0]+_[1],w[1]=_[3]+_[2],w[2]=_[3]-_[2],w[3]=_[0]-_[1],o[Q+0]=w[0]+S[0],o[Q+1]=w[1]+S[1],o[Q+2]=w[2]+S[2],o[Q+3]=w[3]+S[3],o[Q+4]=w[3]-S[3],o[Q+5]=w[2]-S[2],o[Q+6]=w[1]-S[1],o[Q+7]=w[0]-S[0]}for(var X=0;X<8;++X)H[0]=p*o[16+X],H[1]=y*o[16+X],H[2]=p*o[48+X],H[3]=y*o[48+X],S[0]=B*o[8+X]+v*o[24+X]+E*o[40+X]+R*o[56+X],S[1]=v*o[8+X]-R*o[24+X]-B*o[40+X]-E*o[56+X],S[2]=E*o[8+X]-B*o[24+X]+R*o[40+X]+v*o[56+X],S[3]=R*o[8+X]-E*o[24+X]+v*o[40+X]-B*o[56+X],_[0]=u*(o[X]+o[32+X]),_[3]=u*(o[X]-o[32+X]),_[1]=H[0]+H[3],_[2]=H[1]-H[2],w[0]=_[0]+_[1],w[1]=_[3]+_[2],w[2]=_[3]-_[2],w[3]=_[0]-_[1],o[0+X]=w[0]+S[0],o[8+X]=w[1]+S[1],o[16+X]=w[2]+S[2],o[24+X]=w[3]+S[3],o[32+X]=w[3]-S[3],o[40+X]=w[2]-S[2],o[48+X]=w[1]-S[1],o[56+X]=w[0]-S[0]}function Gt(o){for(var u=0;u<64;++u){var B=o[0][u],p=o[1][u],v=o[2][u];o[0][u]=B+1.5747*v,o[1][u]=B-.1873*p-.4682*v,o[2][u]=B+1.8556*p}}function wt(o,u,B){for(var p=0;p<64;++p)u[B+p]=Pt.toHalfFloat(gt(o[p]))}function gt(o){return o<=1?Math.sign(o)*Math.pow(Math.abs(o),2.2):Math.sign(o)*Math.pow(F,Math.abs(o)-1)}function $e(o){return new DataView(o.array.buffer,o.offset.value,o.size)}function Jt(o){var u=o.viewer.buffer.slice(o.offset.value,o.offset.value+o.size),B=new Uint8Array(nt(u)),p=new Uint8Array(B.length);return He(B),qe(B,p),new DataView(p.buffer)}function vt(o){var u=o.array.slice(o.offset.value,o.offset.value+o.size),B=An(u),p=new Uint8Array(B.length);return He(B),qe(B,p),new DataView(p.buffer)}function St(o){for(var u=o.viewer,B={value:o.offset.value},p=new Uint16Array(o.width*o.scanlineBlockSize*(o.channels*o.type)),v=new Uint8Array(8192),E=0,y=new Array(o.channels),R=0;R<o.channels;R++)y[R]={},y[R].start=E,y[R].end=y[R].start,y[R].nx=o.width,y[R].ny=o.lines,y[R].size=o.type,E+=y[R].nx*y[R].ny*y[R].size;var H=xe(u,B),S=xe(u,B);if(S>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(H<=S)for(var R=0;R<S-H+1;R++)v[R+H]=G(u,B);var _=new Uint16Array(65536),w=P(v,_),ve=Re(u,B);ie(o.array,u,B,ve,p,E);for(var R=0;R<o.channels;++R)for(var Q=y[R],X=0;X<y[R].size;++X)Dt(p,Q.start+X,Q.nx,Q.size,Q.ny,Q.nx*Q.size,w);Ne(_,p,E);for(var q=0,te=new Uint8Array(p.buffer.byteLength),Ae=0;Ae<o.lines;Ae++)for(var de=0;de<o.channels;de++){var Q=y[de],Te=Q.nx*Q.size,_e=new Uint8Array(p.buffer,Q.end*2,Te*2);te.set(_e,q),q+=Te*2,Q.end+=Te}return new DataView(te.buffer)}function Ue(o){var u=o.array.slice(o.offset.value,o.offset.value+o.size),B=An(u);const p=o.lines*o.channels*o.width,v=o.type==1?new Uint16Array(p):new Uint32Array(p);let E=0,y=0;const R=new Array(4);for(let H=0;H<o.lines;H++)for(let S=0;S<o.channels;S++){let _=0;switch(o.type){case 1:R[0]=E,R[1]=R[0]+o.width,E=R[1]+o.width;for(let w=0;w<o.width;++w){const ve=B[R[0]++]<<8|B[R[1]++];_+=ve,v[y]=_,y++}break;case 2:R[0]=E,R[1]=R[0]+o.width,R[2]=R[1]+o.width,E=R[2]+o.width;for(let w=0;w<o.width;++w){const ve=B[R[0]++]<<24|B[R[1]++]<<16|B[R[2]++]<<8;_+=ve,v[y]=_,y++}break}}return new DataView(v.buffer)}function on(o){var u=o.viewer,B={value:o.offset.value},p=new Uint8Array(o.width*o.lines*(o.channels*o.type*2)),v={version:K(u,B),unknownUncompressedSize:K(u,B),unknownCompressedSize:K(u,B),acCompressedSize:K(u,B),dcCompressedSize:K(u,B),rleCompressedSize:K(u,B),rleUncompressedSize:K(u,B),rleRawSize:K(u,B),totalAcUncompressedCount:K(u,B),totalDcUncompressedCount:K(u,B),acCompression:K(u,B)};if(v.version<2)throw"EXRLoader.parse: "+kt.compression+" version "+v.version+" is unsupported";for(var E=new Array,y=xe(u,B)-2;y>0;){var R=Ht(u.buffer,B),H=G(u,B),S=H>>2&3,_=(H>>4)-1,w=new Int8Array([_])[0],ve=G(u,B);E.push({name:R,index:w,type:ve,compression:S}),y-=R.length+3}for(var Q=kt.channels,X=new Array(o.channels),q=0;q<o.channels;++q){var te=X[q]={},Ae=Q[q];te.name=Ae.name,te.compression=0,te.decoded=!1,te.type=Ae.pixelType,te.pLinear=Ae.pLinear,te.width=o.width,te.height=o.lines}for(var de={idx:new Array(3)},Te=0;Te<o.channels;++Te)for(var te=X[Te],q=0;q<E.length;++q){var _e=E[q];te.name==_e.name&&(te.compression=_e.compression,_e.index>=0&&(de.idx[_e.index]=Te),te.offset=Te)}if(v.acCompressedSize>0)switch(v.acCompression){case 0:var me=new Uint16Array(v.totalAcUncompressedCount);ie(o.array,u,B,v.acCompressedSize,me,v.totalAcUncompressedCount);break;case 1:var fe=o.array.slice(B.value,B.value+v.totalAcUncompressedCount),et=An(fe),me=new Uint16Array(et.buffer);B.value+=v.totalAcUncompressedCount;break}if(v.dcCompressedSize>0){var De={array:o.array,offset:B,size:v.dcCompressedSize},rt=new Uint16Array(vt(De).buffer);B.value+=v.dcCompressedSize}if(v.rleRawSize>0){var fe=o.array.slice(B.value,B.value+v.rleCompressedSize),et=An(fe),Kt=nt(et.buffer);B.value+=v.rleCompressedSize}for(var Ke=0,he=new Array(X.length),q=0;q<he.length;++q)he[q]=new Array;for(var we=0;we<o.lines;++we)for(var Ce=0;Ce<X.length;++Ce)he[Ce].push(Ke),Ke+=X[Ce].width*o.type*2;yt(de,he,X,me,rt,p);for(var q=0;q<X.length;++q){var te=X[q];if(!te.decoded)switch(te.compression){case 2:for(var ue=0,Qe=0,we=0;we<o.lines;++we){for(var Ft=he[q][ue],Je=0;Je<te.width;++Je){for(var ut=0;ut<2*te.type;++ut)p[Ft++]=Kt[Qe+ut*te.width*te.height];Qe++}ue++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(p.buffer)}function Ht(o,u){for(var B=new Uint8Array(o),p=0;B[u.value+p]!=0;)p+=1;var v=new TextDecoder().decode(B.slice(u.value,u.value+p));return u.value=u.value+p+1,v}function cn(o,u,B){var p=new TextDecoder().decode(new Uint8Array(o).slice(u.value,u.value+B));return u.value=u.value+B,p}function Tn(o,u){var B=lt(o,u),p=Re(o,u);return[B,p]}function bn(o,u){var B=Re(o,u),p=Re(o,u);return[B,p]}function lt(o,u){var B=o.getInt32(u.value,!0);return u.value=u.value+4,B}function Re(o,u){var B=o.getUint32(u.value,!0);return u.value=u.value+4,B}function m(o,u){var B=o[u.value];return u.value=u.value+1,B}function G(o,u){var B=o.getUint8(u.value);return u.value=u.value+1,B}const K=function(o,u){let B;return"getBigInt64"in DataView.prototype?B=Number(o.getBigInt64(u.value,!0)):B=o.getUint32(u.value+4,!0)+Number(o.getUint32(u.value,!0)<<32),u.value+=8,B};function Z(o,u){var B=o.getFloat32(u.value,!0);return u.value+=4,B}function Ie(o,u){return Pt.toHalfFloat(Z(o,u))}function x(o){var u=(o&31744)>>10,B=o&1023;return(o>>15?-1:1)*(u?u===31?B?NaN:1/0:Math.pow(2,u-15)*(1+B/1024):6103515625e-14*(B/1024))}function xe(o,u){var B=o.getUint16(u.value,!0);return u.value+=2,B}function er(o,u){return x(xe(o,u))}function ln(o,u,B,p){for(var v=B.value,E=[];B.value<v+p-1;){var y=Ht(u,B),R=lt(o,B),H=G(o,B);B.value+=3;var S=lt(o,B),_=lt(o,B);E.push({name:y,pixelType:R,pLinear:H,xSampling:S,ySampling:_})}return B.value+=1,E}function We(o,u){var B=Z(o,u),p=Z(o,u),v=Z(o,u),E=Z(o,u),y=Z(o,u),R=Z(o,u),H=Z(o,u),S=Z(o,u);return{redX:B,redY:p,greenX:v,greenY:E,blueX:y,blueY:R,whiteX:H,whiteY:S}}function Ve(o,u){var B=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],p=G(o,u);return B[p]}function Et(o,u){var B=Re(o,u),p=Re(o,u),v=Re(o,u),E=Re(o,u);return{xMin:B,yMin:p,xMax:v,yMax:E}}function Mt(o,u){var B=["INCREASING_Y"],p=G(o,u);return B[p]}function It(o,u){var B=Z(o,u),p=Z(o,u);return[B,p]}function _t(o,u){var B=Z(o,u),p=Z(o,u),v=Z(o,u);return[B,p,v]}function Zr(o,u,B,p,v){if(p==="string"||p==="stringvector"||p==="iccProfile")return cn(u,B,v);if(p==="chlist")return ln(o,u,B,v);if(p==="chromaticities")return We(o,B);if(p==="compression")return Ve(o,B);if(p==="box2i")return Et(o,B);if(p==="lineOrder")return Mt(o,B);if(p==="float")return Z(o,B);if(p==="v2f")return It(o,B);if(p==="v3f")return _t(o,B);if(p==="int")return lt(o,B);if(p==="rational")return Tn(o,B);if(p==="timecode")return bn(o,B);if(p==="preview")return B.value+=v,"skipped";B.value+=v}function Wr(o,u,B){const p={};if(o.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";p.version=o.getUint8(4);const v=o.getUint8(5);p.spec={singleTile:!!(v&2),longName:!!(v&4),deepFormat:!!(v&8),multiPart:!!(v&16)},B.value=8;for(var E=!0;E;){var y=Ht(u,B);if(y==0)E=!1;else{var R=Ht(u,B),H=Re(o,B),S=Zr(o,u,B,R,H);S===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${R}'.`):p[y]=S}}if(v&-5)throw console.error("EXRHeader:",p),"THREE.EXRLoader: provided file is currently unsupported.";return p}function Vr(o,u,B,p,v){const E={size:0,viewer:u,array:B,offset:p,width:o.dataWindow.xMax-o.dataWindow.xMin+1,height:o.dataWindow.yMax-o.dataWindow.yMin+1,channels:o.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:o.channels[0].pixelType,uncompress:null,getter:null,format:null,[Xt?"colorSpace":"encoding"]:null};switch(o.compression){case"NO_COMPRESSION":E.lines=1,E.uncompress=$e;break;case"RLE_COMPRESSION":E.lines=1,E.uncompress=Jt;break;case"ZIPS_COMPRESSION":E.lines=1,E.uncompress=vt;break;case"ZIP_COMPRESSION":E.lines=16,E.uncompress=vt;break;case"PIZ_COMPRESSION":E.lines=32,E.uncompress=St;break;case"PXR24_COMPRESSION":E.lines=16,E.uncompress=Ue;break;case"DWAA_COMPRESSION":E.lines=32,E.uncompress=on;break;case"DWAB_COMPRESSION":E.lines=256,E.uncompress=on;break;default:throw"EXRLoader.parse: "+o.compression+" is unsupported"}if(E.scanlineBlockSize=E.lines,E.type==1)switch(v){case it:E.getter=er,E.inputSize=2;break;case Ze:E.getter=xe,E.inputSize=2;break}else if(E.type==2)switch(v){case it:E.getter=Z,E.inputSize=4;break;case Ze:E.getter=Ie,E.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+E.type+" for "+o.compression+".";E.blockCount=(o.dataWindow.yMax+1)/E.scanlineBlockSize;for(var y=0;y<E.blockCount;y++)K(u,p);E.outputChannels=E.channels==3?4:E.channels;const R=E.width*E.height*E.outputChannels;switch(v){case it:E.byteArray=new Float32Array(R),E.channels<E.outputChannels&&E.byteArray.fill(1,0,R);break;case Ze:E.byteArray=new Uint16Array(R),E.channels<E.outputChannels&&E.byteArray.fill(15360,0,R);break;default:console.error("THREE.EXRLoader: unsupported type: ",v);break}return E.bytesPerLine=E.width*E.inputSize*E.channels,E.outputChannels==4?E.format=en:E.format=_s,Xt?E.colorSpace="srgb-linear":E.encoding=3e3,E}const un=new DataView(e),zr=new Uint8Array(e),Nt={value:0},kt=Wr(un,e,Nt),ae=Vr(kt,un,zr,Nt,this.type),tr={value:0},qr={R:0,G:1,B:2,A:3,Y:0};for(let o=0;o<ae.height/ae.scanlineBlockSize;o++){const u=Re(un,Nt);ae.size=Re(un,Nt),ae.lines=u+ae.scanlineBlockSize>ae.height?ae.height-u:ae.scanlineBlockSize;const p=ae.size<ae.lines*ae.bytesPerLine?ae.uncompress(ae):$e(ae);Nt.value+=ae.size;for(let v=0;v<ae.scanlineBlockSize;v++){const E=v+o*ae.scanlineBlockSize;if(E>=ae.height)break;for(let y=0;y<ae.channels;y++){const R=qr[kt.channels[y].name];for(let H=0;H<ae.width;H++){tr.value=(v*(ae.channels*ae.width)+y*ae.width+H)*ae.inputSize;const S=(ae.height-1-E)*(ae.width*ae.outputChannels)+H*ae.outputChannels+R;ae.byteArray[S]=ae.getter(p,tr)}}}}return{header:kt,width:ae.width,height:ae.height,data:ae.byteArray,format:ae.format,[Xt?"colorSpace":"encoding"]:ae[Xt?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,n,t,r){function s(a,c){Xt?a.colorSpace=c.colorSpace:a.encoding=c.encoding,a.minFilter=Ye,a.magFilter=Ye,a.generateMipmaps=!1,a.flipY=!1,n&&n(a,c)}return super.load(e,s,t,r)}}const _n=new WeakMap;class Bo extends Yn{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,n,t,r){const s=new Bt(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,a=>{const c={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(a,c).then(n).catch(r)},t,r)}decodeDracoFile(e,n,t,r){const s={attributeIDs:t||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!t};this.decodeGeometry(e,s).then(n)}decodeGeometry(e,n){for(const i in n.attributeTypes){const A=n.attributeTypes[i];A.BYTES_PER_ELEMENT!==void 0&&(n.attributeTypes[i]=A.name)}const t=JSON.stringify(n);if(_n.has(e)){const i=_n.get(e);if(i.key===t)return i.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,a=e.byteLength,c=this._getWorker(s,a).then(i=>(r=i,new Promise((A,h)=>{r._callbacks[s]={resolve:A,reject:h},r.postMessage({type:"decode",id:s,taskConfig:n,buffer:e},[e])}))).then(i=>this._createGeometry(i.geometry));return c.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),_n.set(e,{key:t,promise:c}),c}_createGeometry(e){const n=new br;e.index&&n.setIndex(new Vt(e.index.array,1));for(let t=0;t<e.attributes.length;t++){const r=e.attributes[t],s=r.name,a=r.array,c=r.itemSize;n.setAttribute(s,new Vt(a,c))}return n}_loadLibrary(e,n){const t=new Bt(this.manager);return t.setPath(this.decoderPath),t.setResponseType(n),t.setWithCredentials(this.withCredentials),new Promise((r,s)=>{t.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",n=[];return e?n.push(this._loadLibrary("draco_decoder.js","text")):(n.push(this._loadLibrary("draco_wasm_wrapper.js","text")),n.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(n).then(t=>{const r=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const s=mo.toString(),a=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([a]))}),this.decoderPending}_getWorker(e,n){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const a=s.data;switch(a.type){case"decode":r._callbacks[a.id].resolve(a);break;case"error":r._callbacks[a.id].reject(a);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+a.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const t=this.workerPool[this.workerPool.length-1];return t._taskCosts[e]=n,t._taskLoad+=n,t})}_releaseTask(e,n){e._taskLoad-=e._taskCosts[n],delete e._callbacks[n],delete e._taskCosts[n]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function mo(){let l,e;onmessage=function(a){const c=a.data;switch(c.type){case"init":l=c.decoderConfig,e=new Promise(function(h){l.onModuleLoaded=function(d){h({draco:d})},DracoDecoderModule(l)});break;case"decode":const i=c.buffer,A=c.taskConfig;e.then(h=>{const d=h.draco,f=new d.Decoder,C=new d.DecoderBuffer;C.Init(new Int8Array(i),i.byteLength);try{const g=n(d,f,C,A),T=g.attributes.map(M=>M.array.buffer);g.index&&T.push(g.index.array.buffer),self.postMessage({type:"decode",id:c.id,geometry:g},T)}catch(g){console.error(g),self.postMessage({type:"error",id:c.id,error:g.message})}finally{d.destroy(C),d.destroy(f)}});break}};function n(a,c,i,A){const h=A.attributeIDs,d=A.attributeTypes;let f,C;const g=c.GetEncodedGeometryType(i);if(g===a.TRIANGULAR_MESH)f=new a.Mesh,C=c.DecodeBufferToMesh(i,f);else if(g===a.POINT_CLOUD)f=new a.PointCloud,C=c.DecodeBufferToPointCloud(i,f);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!C.ok()||f.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+C.error_msg());const T={index:null,attributes:[]};for(const M in h){const I=self[d[M]];let L,J;if(A.useUniqueIDs)J=h[M],L=c.GetAttributeByUniqueId(f,J);else{if(J=c.GetAttributeId(f,a[h[M]]),J===-1)continue;L=c.GetAttribute(f,J)}T.attributes.push(r(a,c,f,M,I,L))}return g===a.TRIANGULAR_MESH&&(T.index=t(a,c,f)),a.destroy(f),T}function t(a,c,i){const h=i.num_faces()*3,d=h*4,f=a._malloc(d);c.GetTrianglesUInt32Array(i,d,f);const C=new Uint32Array(a.HEAPF32.buffer,f,h).slice();return a._free(f),{array:C,itemSize:1}}function r(a,c,i,A,h,d){const f=d.num_components(),g=i.num_points()*f,T=g*h.BYTES_PER_ELEMENT,M=s(a,h),I=a._malloc(T);c.GetAttributeDataArrayForAllPoints(i,d,M,T,I);const L=new h(a.HEAPF32.buffer,I,g).slice();return a._free(I),{name:A,array:L,itemSize:f}}function s(a,c){switch(c){case Float32Array:return a.DT_FLOAT32;case Int8Array:return a.DT_INT8;case Int16Array:return a.DT_INT16;case Int32Array:return a.DT_INT32;case Uint8Array:return a.DT_UINT8;case Uint16Array:return a.DT_UINT16;case Uint32Array:return a.DT_UINT32}}}let dn;const xn=()=>{if(dn)return dn;const l="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",e="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",n=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),t=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let r=l;WebAssembly.validate(n)&&(r=e);let s;const a=WebAssembly.instantiate(c(r),{}).then(d=>{s=d.instance,s.exports.__wasm_call_ctors()});function c(d){const f=new Uint8Array(d.length);for(let g=0;g<d.length;++g){const T=d.charCodeAt(g);f[g]=T>96?T-71:T>64?T-65:T>47?T+4:T>46?63:62}let C=0;for(let g=0;g<d.length;++g)f[C++]=f[g]<60?t[f[g]]:(f[g]-60)*64+f[++g];return f.buffer.slice(0,C)}function i(d,f,C,g,T,M){const I=s.exports.sbrk,L=C+3&-4,J=I(L*g),U=I(T.length),O=new Uint8Array(s.exports.memory.buffer);O.set(T,U);const D=d(J,C,g,U,T.length);if(D===0&&M&&M(J,L,g),f.set(O.subarray(J,J+C*g)),I(J-I(0)),D!==0)throw new Error(`Malformed buffer data: ${D}`)}const A={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},h={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return dn={ready:a,supported:!0,decodeVertexBuffer(d,f,C,g,T){i(s.exports.meshopt_decodeVertexBuffer,d,f,C,g,s.exports[A[T]])},decodeIndexBuffer(d,f,C,g){i(s.exports.meshopt_decodeIndexBuffer,d,f,C,g)},decodeIndexSequence(d,f,C,g){i(s.exports.meshopt_decodeIndexSequence,d,f,C,g)},decodeGltfBuffer(d,f,C,g,T,M){i(s.exports[h[T]],d,f,C,g,s.exports[A[M]])}},dn};let fn=null,Jr="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function Nr(l,e,n){return t=>{n&&n(t),l&&(fn||(fn=new Bo),fn.setDecoderPath(typeof l=="string"?l:Jr),t.setDRACOLoader(fn)),e&&t.setMeshoptDecoder(typeof xn=="function"?xn():xn)}}function Fn(l,e=!0,n=!0,t){return tn(Vn,l,Nr(e,n,t))}Fn.preload=(l,e=!0,n=!0,t)=>tn.preload(Vn,l,Nr(e,n,t));Fn.clear=l=>tn.clear(Vn,l);Fn.setDecoderPath=l=>{Jr=l};const po=N.forwardRef(({makeDefault:l,camera:e,regress:n,domElement:t,enableDamping:r=!0,keyEvents:s=!1,onChange:a,onStart:c,onEnd:i,...A},h)=>{const d=Se(D=>D.invalidate),f=Se(D=>D.camera),C=Se(D=>D.gl),g=Se(D=>D.events),T=Se(D=>D.setEvents),M=Se(D=>D.set),I=Se(D=>D.get),L=Se(D=>D.performance),J=e||f,U=t||g.connected||C.domElement,O=N.useMemo(()=>new Da(J),[J]);return nn(()=>{O.enabled&&O.update()},-1),N.useEffect(()=>(s&&O.connect(s===!0?U:s),O.connect(U),()=>void O.dispose()),[s,U,n,O,d]),N.useEffect(()=>{const D=F=>{d(),n&&L.regress(),a&&a(F)},Y=F=>{c&&c(F)},b=F=>{i&&i(F)};return O.addEventListener("change",D),O.addEventListener("start",Y),O.addEventListener("end",b),()=>{O.removeEventListener("start",Y),O.removeEventListener("end",b),O.removeEventListener("change",D)}},[a,c,i,O,d,T]),N.useEffect(()=>{if(l){const D=I().controls;return M({controls:O}),()=>M({controls:D})}},[l,O]),N.createElement("primitive",In({ref:h,object:O,enableDamping:r},A))}),Co=3e3,go=3001,kr=(l,e,n)=>{let t;switch(l){case Jn:t=new Uint8ClampedArray(e*n*4);break;case Ze:t=new Uint16Array(e*n*4);break;case Js:t=new Uint32Array(e*n*4);break;case Us:t=new Int8Array(e*n*4);break;case Ps:t=new Int16Array(e*n*4);break;case Os:t=new Int32Array(e*n*4);break;case it:t=new Float32Array(e*n*4);break;default:throw new Error("Unsupported data type")}return t};let Bn;const vo=(l,e,n,t)=>{if(Bn!==void 0)return Bn;const r=new gn(1,1,t);e.setRenderTarget(r);const s=new rn(new Zn,new Ot({color:16777215}));e.render(s,n),e.setRenderTarget(null);const a=kr(l,r.width,r.height);return e.readRenderTargetPixels(r,0,0,r.width,r.height,a),r.dispose(),s.geometry.dispose(),s.material.dispose(),Bn=a[0]!==0,Bn};class zn{constructor(e){var n,t,r,s,a,c,i,A,h,d,f,C,g,T,M,I;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(J){throw this._renderer.setRenderTarget(null),J}this._renderer.setRenderTarget(null)},this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const L={format:en,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((n=e.renderTargetOptions)===null||n===void 0?void 0:n.anisotropy)!==void 0?(t=e.renderTargetOptions)===null||t===void 0?void 0:t.anisotropy:1,generateMipmaps:((r=e.renderTargetOptions)===null||r===void 0?void 0:r.generateMipmaps)!==void 0?(s=e.renderTargetOptions)===null||s===void 0?void 0:s.generateMipmaps:!1,magFilter:((a=e.renderTargetOptions)===null||a===void 0?void 0:a.magFilter)!==void 0?(c=e.renderTargetOptions)===null||c===void 0?void 0:c.magFilter:Ye,minFilter:((i=e.renderTargetOptions)===null||i===void 0?void 0:i.minFilter)!==void 0?(A=e.renderTargetOptions)===null||A===void 0?void 0:A.minFilter:Ye,samples:((h=e.renderTargetOptions)===null||h===void 0?void 0:h.samples)!==void 0?(d=e.renderTargetOptions)===null||d===void 0?void 0:d.samples:void 0,wrapS:((f=e.renderTargetOptions)===null||f===void 0?void 0:f.wrapS)!==void 0?(C=e.renderTargetOptions)===null||C===void 0?void 0:C.wrapS:at,wrapT:((g=e.renderTargetOptions)===null||g===void 0?void 0:g.wrapT)!==void 0?(T=e.renderTargetOptions)===null||T===void 0?void 0:T.wrapT:at};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=zn.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new yr,this._camera=new dt,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!vo(this._type,this._renderer,this._camera,L)){let J;switch(this._type){case Ze:J=this._renderer.extensions.has("EXT_color_buffer_float")?it:void 0;break}J!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${it}`),this._type=J):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new rn(new Zn,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new gn(this.width,this.height,L),this._renderTarget.texture.mapping=((M=e.renderTargetOptions)===null||M===void 0?void 0:M.mapping)!==void 0?(I=e.renderTargetOptions)===null||I===void 0?void 0:I.mapping:vn}static instantiateRenderer(){const e=new xs;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=kr(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const n=new Ls(this.toArray(),this.width,this.height,en,this._type,(e==null?void 0:e.mapping)||vn,(e==null?void 0:e.wrapS)||at,(e==null?void 0:e.wrapT)||at,(e==null?void 0:e.magFilter)||Ye,(e==null?void 0:e.minFilter)||Ye,(e==null?void 0:e.anisotropy)||1,Un);return n.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,n}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof $t&&Object.values(this.material.uniforms).forEach(n=>{n.value instanceof ot&&n.value.dispose()}),Object.values(this.material).forEach(n=>{n instanceof ot&&n.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}const Eo=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,Mo=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class Io extends $t{constructor({gamma:e,offsetHdr:n,offsetSdr:t,gainMapMin:r,gainMapMax:s,maxDisplayBoost:a,hdrCapacityMin:c,hdrCapacityMax:i,sdr:A,gainMap:h}){super({name:"GainMapDecoderMaterial",vertexShader:Eo,fragmentShader:Mo,uniforms:{sdr:{value:A},gainMap:{value:h},gamma:{value:new Be(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new Be().fromArray(n)},offsetSdr:{value:new Be().fromArray(t)},gainMapMin:{value:new Be().fromArray(r)},gainMapMax:{value:new Be().fromArray(s)},weightFactor:{value:(Math.log2(a)-c)/(i-c)}},blending:Ks,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=a,this._hdrCapacityMin=c,this._hdrCapacityMax=i,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const n=this.uniforms.gamma.value;n.x=1/e[0],n.y=1/e[1],n.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class Kr extends Error{}class Qr extends Error{}const jt=(l,e,n)=>{var t;let r;const s=(t=l.attributes.getNamedItem(e))===null||t===void 0?void 0:t.nodeValue;if(s)r=s;else{const a=l.getElementsByTagName(e)[0];if(a){const c=a.getElementsByTagName("rdf:li");if(c.length===3)r=Array.from(c).map(i=>i.innerHTML);else throw new Error(`Gainmap metadata contains an array of items for ${e} but its length is not 3`)}else{if(n)return n;throw new Error(`Can't find ${e} in gainmap metadata`)}}return r},Fo=l=>{var e,n;let t;typeof TextDecoder<"u"?t=new TextDecoder().decode(l):t=l.toString();let r=t.indexOf("<x:xmpmeta");const s=new DOMParser;for(;r!==-1;){const a=t.indexOf("x:xmpmeta>",r);t.slice(r,a+10);const c=t.slice(r,a+10);try{const A=s.parseFromString(c,"text/xml").getElementsByTagName("rdf:Description")[0],h=jt(A,"hdrgm:GainMapMin","0"),d=jt(A,"hdrgm:GainMapMax"),f=jt(A,"hdrgm:Gamma","1"),C=jt(A,"hdrgm:OffsetSDR","0.015625"),g=jt(A,"hdrgm:OffsetHDR","0.015625");let T=(e=A.attributes.getNamedItem("hdrgm:HDRCapacityMin"))===null||e===void 0?void 0:e.nodeValue;T||(T="0");const M=(n=A.attributes.getNamedItem("hdrgm:HDRCapacityMax"))===null||n===void 0?void 0:n.nodeValue;if(!M)throw new Error("Incomplete gainmap metadata");return{gainMapMin:Array.isArray(h)?h.map(I=>parseFloat(I)):[parseFloat(h),parseFloat(h),parseFloat(h)],gainMapMax:Array.isArray(d)?d.map(I=>parseFloat(I)):[parseFloat(d),parseFloat(d),parseFloat(d)],gamma:Array.isArray(f)?f.map(I=>parseFloat(I)):[parseFloat(f),parseFloat(f),parseFloat(f)],offsetSdr:Array.isArray(C)?C.map(I=>parseFloat(I)):[parseFloat(C),parseFloat(C),parseFloat(C)],offsetHdr:Array.isArray(g)?g.map(I=>parseFloat(I)):[parseFloat(g),parseFloat(g),parseFloat(g)],hdrCapacityMin:parseFloat(T),hdrCapacityMax:parseFloat(M)}}catch{}r=t.indexOf("<x:xmpmeta",a)}};class To{constructor(e){this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((n,t)=>{const r=this.options.debug,s=new DataView(e.buffer);if(s.getUint16(0)!==65496){t(new Error("Not a valid jpeg"));return}const a=s.byteLength;let c=2,i=0,A;for(;c<a;){if(++i>250){t(new Error(`Found no marker after ${i} loops `));return}if(s.getUint8(c)!==255){t(new Error(`Not a valid marker at offset 0x${c.toString(16)}, found: 0x${s.getUint8(c).toString(16)}`));return}if(A=s.getUint8(c+1),r&&console.log(`Marker: ${A.toString(16)}`),A===226){r&&console.log("Found APP2 marker (0xffe2)");const h=c+4;if(s.getUint32(h)===1297106432){const d=h+4;let f;if(s.getUint16(d)===18761)f=!1;else if(s.getUint16(d)===19789)f=!0;else{t(new Error("No valid endianness marker found in TIFF header"));return}if(s.getUint16(d+2,!f)!==42){t(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const C=s.getUint32(d+4,!f);if(C<8){t(new Error("Not valid TIFF data! (First offset less than 8)"));return}const g=d+C,T=s.getUint16(g,!f),M=g+2;let I=0;for(let O=M;O<M+12*T;O+=12)s.getUint16(O,!f)===45057&&(I=s.getUint32(O+8,!f));const L=4,J=g+2+T*12+L,U=[];for(let O=J;O<J+I*16;O+=16){const D={MPType:s.getUint32(O,!f),size:s.getUint32(O+4,!f),dataOffset:s.getUint32(O+8,!f),dependantImages:s.getUint32(O+12,!f),start:-1,end:-1,isFII:!1};D.dataOffset?(D.start=d+D.dataOffset,D.isFII=!1):(D.start=0,D.isFII=!0),D.end=D.start+D.size,U.push(D)}if(this.options.extractNonFII&&U.length){const O=new Blob([s]),D=[];for(const Y of U){if(Y.isFII&&!this.options.extractFII)continue;const b=O.slice(Y.start,Y.end+1,"image/jpeg");D.push(b)}n(D)}}}c+=2+s.getUint16(c+2)}})}}const bo=async l=>{const e=Fo(l);if(!e)throw new Qr("Gain map XMP metadata not found");const t=await new To({extractFII:!0,extractNonFII:!0}).extract(l);if(t.length!==2)throw new Kr("Gain map recovery image not found");return{sdr:new Uint8Array(await t[0].arrayBuffer()),gainMap:new Uint8Array(await t[1].arrayBuffer()),metadata:e}},pr=l=>new Promise((e,n)=>{const t=document.createElement("img");t.onload=()=>{e(t)},t.onerror=r=>{n(r)},t.src=URL.createObjectURL(l)});class Xr extends Yn{constructor(e,n){super(n),e&&(this._renderer=e),this._internalLoadingManager=new Ns}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const e=new Io({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new ot,sdr:new ot});return new zn({width:16,height:16,type:Ze,colorSpace:Un,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(e,n,t,r){const s=r?new Blob([r],{type:"image/jpeg"}):void 0,a=new Blob([t],{type:"image/jpeg"});let c,i,A=!1;if(typeof createImageBitmap>"u"){const f=await Promise.all([s?pr(s):Promise.resolve(void 0),pr(a)]);i=f[0],c=f[1],A=!0}else{const f=await Promise.all([s?createImageBitmap(s,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(a,{imageOrientation:"flipY"})]);i=f[0],c=f[1]}const h=new ot(i||new ImageData(2,2),vn,at,at,Ye,or,en,Jn,1,Un);h.flipY=A,h.needsUpdate=!0;const d=new ot(c,vn,at,at,Ye,or,en,Jn,1,ks);d.flipY=A,d.needsUpdate=!0,e.width=c.width,e.height=c.height,e.material.gainMap=h,e.material.sdr=d,e.material.gainMapMin=n.gainMapMin,e.material.gainMapMax=n.gainMapMax,e.material.offsetHdr=n.offsetHdr,e.material.offsetSdr=n.offsetSdr,e.material.gamma=n.gamma,e.material.hdrCapacityMin=n.hdrCapacityMin,e.material.hdrCapacityMax=n.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,n.hdrCapacityMax),e.material.needsUpdate=!0,e.render()}}class Ro extends Xr{load([e,n,t],r,s,a){const c=this.prepareQuadRenderer();let i,A,h;const d=async()=>{if(i&&A&&h){try{await this.render(c,h,i,A)}catch(F){this.manager.itemError(e),this.manager.itemError(n),this.manager.itemError(t),typeof a=="function"&&a(F),c.disposeOnDemandRenderer();return}typeof r=="function"&&r(c),this.manager.itemEnd(e),this.manager.itemEnd(n),this.manager.itemEnd(t),c.disposeOnDemandRenderer()}};let f=!0,C=0,g=0,T=!0,M=0,I=0,L=!0,J=0,U=0;const O=()=>{if(typeof s=="function"){const F=C+M+J,P=g+I+U,j=f&&T&&L;s(new ProgressEvent("progress",{lengthComputable:j,loaded:P,total:F}))}};this.manager.itemStart(e),this.manager.itemStart(n),this.manager.itemStart(t);const D=new Bt(this._internalLoadingManager);D.setResponseType("arraybuffer"),D.setRequestHeader(this.requestHeader),D.setPath(this.path),D.setWithCredentials(this.withCredentials),D.load(e,async F=>{if(typeof F=="string")throw new Error("Invalid sdr buffer");i=F,await d()},F=>{f=F.lengthComputable,g=F.loaded,C=F.total,O()},F=>{this.manager.itemError(e),typeof a=="function"&&a(F)});const Y=new Bt(this._internalLoadingManager);Y.setResponseType("arraybuffer"),Y.setRequestHeader(this.requestHeader),Y.setPath(this.path),Y.setWithCredentials(this.withCredentials),Y.load(n,async F=>{if(typeof F=="string")throw new Error("Invalid gainmap buffer");A=F,await d()},F=>{T=F.lengthComputable,I=F.loaded,M=F.total,O()},F=>{this.manager.itemError(n),typeof a=="function"&&a(F)});const b=new Bt(this._internalLoadingManager);return b.setRequestHeader(this.requestHeader),b.setPath(this.path),b.setWithCredentials(this.withCredentials),b.load(t,async F=>{if(typeof F!="string")throw new Error("Invalid metadata string");h=JSON.parse(F),await d()},F=>{L=F.lengthComputable,U=F.loaded,J=F.total,O()},F=>{this.manager.itemError(t),typeof a=="function"&&a(F)}),c}}class Do extends Xr{load(e,n,t,r){const s=this.prepareQuadRenderer(),a=new Bt(this._internalLoadingManager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(this.withCredentials),this.manager.itemStart(e),a.load(e,async c=>{if(typeof c=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const i=new Uint8Array(c);let A,h,d;try{const f=await bo(i);A=f.sdr,h=f.gainMap,d=f.metadata}catch(f){if(f instanceof Qr||f instanceof Kr)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),d={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},A=i;else throw f}try{await this.render(s,d,A,h)}catch(f){this.manager.itemError(e),typeof r=="function"&&r(f),s.disposeOnDemandRenderer();return}typeof n=="function"&&n(s),this.manager.itemEnd(e),s.disposeOnDemandRenderer()},t,c=>{this.manager.itemError(e),typeof r=="function"&&r(c)}),s}}const Ln={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},yo="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",mn=l=>Array.isArray(l);function jr({files:l=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"],path:e="",preset:n=void 0,encoding:t=void 0,extensions:r}={}){var s;let a=null,c=!1;if(n){if(!(n in Ln))throw new Error("Preset must be one of: "+Object.keys(Ln).join(", "));l=Ln[n],e=yo}const i=mn(l)&&l.length===6,A=mn(l)&&l.length===3&&l.some(M=>M.endsWith("json")),h=mn(l)?l[0]:l;c=mn(l);const d=i?"cube":A?"webp":h.startsWith("data:application/exr")?"exr":h.startsWith("data:application/hdr")?"hdr":h.startsWith("data:image/jpeg")?"jpg":(s=h.split(".").pop())==null||(s=s.split("?"))==null||(s=s.shift())==null?void 0:s.toLowerCase();if(a=d==="cube"?js:d==="hdr"?ho:d==="exr"?fo:d==="jpg"||d==="jpeg"?Do:d==="webp"?Ro:null,!a)throw new Error("useEnvironment: Unrecognized file extension: "+l);const f=Se(M=>M.gl);N.useLayoutEffect(()=>{if(d!=="webp"&&d!=="jpg"&&d!=="jpeg")return;function M(){tn.clear(a,c?[l]:l)}f.domElement.addEventListener("webglcontextlost",M,{once:!0})},[l,f.domElement]);const C=tn(a,c?[l]:l,M=>{(d==="webp"||d==="jpg"||d==="jpeg")&&M.setRenderer(f),M.setPath==null||M.setPath(e),r&&r(M)});let g=c?C[0]:C;if(d==="jpg"||d==="jpeg"||d==="webp"){var T;g=(T=g.renderTarget)==null?void 0:T.texture}return g.mapping=i?Qs:Xs,"colorSpace"in g?g.colorSpace=t??i?"srgb":"srgb-linear":g.encoding=t??i?go:Co,g}const Go=l=>l.current&&l.current.isScene,wo=l=>Go(l)?l.current:l;function qn(l,e,n,t,r={}){var s,a,c,i,A;r={backgroundBlurriness:(s=r.blur)!==null&&s!==void 0?s:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...r};const h=wo(e||n),d=h.background,f=h.environment,C={backgroundBlurriness:h.backgroundBlurriness,backgroundIntensity:h.backgroundIntensity,backgroundRotation:(a=(c=h.backgroundRotation)==null||c.clone==null?void 0:c.clone())!==null&&a!==void 0?a:[0,0,0],environmentIntensity:h.environmentIntensity,environmentRotation:(i=(A=h.environmentRotation)==null||A.clone==null?void 0:A.clone())!==null&&i!==void 0?i:[0,0,0]};return l!=="only"&&(h.environment=t),l&&(h.background=t),ir(h,r),()=>{l!=="only"&&(h.environment=f),l&&(h.background=d),ir(h,C)}}function $n({scene:l,background:e=!1,map:n,...t}){const r=Se(s=>s.scene);return N.useLayoutEffect(()=>{if(n)return qn(e,l,r,n,t)}),null}function Yr({background:l=!1,scene:e,blur:n,backgroundBlurriness:t,backgroundIntensity:r,backgroundRotation:s,environmentIntensity:a,environmentRotation:c,...i}){const A=jr(i),h=Se(d=>d.scene);return N.useLayoutEffect(()=>qn(l,e,h,A,{blur:n,backgroundBlurriness:t,backgroundIntensity:r,backgroundRotation:s,environmentIntensity:a,environmentRotation:c})),null}function So({children:l,near:e=1,far:n=1e3,resolution:t=256,frames:r=1,map:s,background:a=!1,blur:c,backgroundBlurriness:i,backgroundIntensity:A,backgroundRotation:h,environmentIntensity:d,environmentRotation:f,scene:C,files:g,path:T,preset:M=void 0,extensions:I}){const L=Se(b=>b.gl),J=Se(b=>b.scene),U=N.useRef(null),[O]=N.useState(()=>new yr),D=N.useMemo(()=>{const b=new Ys(t);return b.texture.type=Ze,b},[t]);N.useLayoutEffect(()=>(r===1&&U.current.update(L,O),qn(a,C,J,D.texture,{blur:c,backgroundBlurriness:i,backgroundIntensity:A,backgroundRotation:h,environmentIntensity:d,environmentRotation:f})),[l,O,D.texture,C,J,a,r,L]);let Y=1;return nn(()=>{(r===1/0||Y<r)&&(U.current.update(L,O),Y++)}),N.createElement(N.Fragment,null,Zs(N.createElement(N.Fragment,null,l,N.createElement("cubeCamera",{ref:U,args:[e,n,D]}),g||M?N.createElement(Yr,{background:!0,files:g,preset:M,path:T,extensions:I}):s?N.createElement($n,{background:!0,map:s,extensions:I}):null),O))}function Ho(l){var e,n,t,r;const s=jr(l),a=l.map||s;N.useMemo(()=>Ws({GroundProjectedEnvImpl:Fa}),[]);const c=N.useMemo(()=>[a],[a]),i=(e=l.ground)==null?void 0:e.height,A=(n=l.ground)==null?void 0:n.radius,h=(t=(r=l.ground)==null?void 0:r.scale)!==null&&t!==void 0?t:1e3;return N.createElement(N.Fragment,null,N.createElement($n,In({},l,{map:a})),N.createElement("groundProjectedEnvImpl",{args:c,scale:h,height:i,radius:A}))}function _o(l){return l.ground?N.createElement(Ho,l):l.map?N.createElement($n,l):l.children?N.createElement(So,l):N.createElement(Yr,l)}const xo=N.forwardRef(({scale:l=10,frames:e=1/0,opacity:n=1,width:t=1,height:r=1,blur:s=1,near:a=0,far:c=10,resolution:i=512,smooth:A=!0,color:h="#000000",depthWrite:d=!1,renderOrder:f,...C},g)=>{const T=N.useRef(null),M=Se(k=>k.scene),I=Se(k=>k.gl),L=N.useRef(null);t=t*(Array.isArray(l)?l[0]:l||1),r=r*(Array.isArray(l)?l[1]:l||1);const[J,U,O,D,Y,b,F]=N.useMemo(()=>{const k=new gn(i,i),z=new gn(i,i);z.texture.generateMipmaps=k.texture.generateMipmaps=!1;const W=new Zn(t,r).rotateX(Math.PI/2),ce=new rn(W),Ee=new Vs;Ee.depthTest=Ee.depthWrite=!1,Ee.onBeforeCompile=Me=>{Me.uniforms={...Me.uniforms,ucolor:{value:new mt(h)}},Me.fragmentShader=Me.fragmentShader.replace("void main() {",`uniform vec3 ucolor;
           void main() {
          `),Me.fragmentShader=Me.fragmentShader.replace("vec4( vec3( 1.0 - fragCoordZ ), opacity );","vec4( ucolor * fragCoordZ * 2.0, ( 1.0 - fragCoordZ ) * 1.0 );")};const ge=new $t(uo),ne=new $t(Ao);return ne.depthTest=ge.depthTest=!1,[k,W,Ee,ce,ge,ne,z]},[i,t,r,l,h]),P=k=>{D.visible=!0,D.material=Y,Y.uniforms.tDiffuse.value=J.texture,Y.uniforms.h.value=k*1/256,I.setRenderTarget(F),I.render(D,L.current),D.material=b,b.uniforms.tDiffuse.value=F.texture,b.uniforms.v.value=k*1/256,I.setRenderTarget(J),I.render(D,L.current),D.visible=!1};let j=0,ee,$;return nn(()=>{L.current&&(e===1/0||j<e)&&(j++,ee=M.background,$=M.overrideMaterial,T.current.visible=!1,M.background=null,M.overrideMaterial=O,I.setRenderTarget(J),I.render(M,L.current),P(s),A&&P(s*.4),I.setRenderTarget(null),T.current.visible=!0,M.overrideMaterial=$,M.background=ee)}),N.useImperativeHandle(g,()=>T.current,[]),N.createElement("group",In({"rotation-x":Math.PI/2},C,{ref:T}),N.createElement("mesh",{renderOrder:f,geometry:U,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},N.createElement("meshBasicMaterial",{transparent:!0,map:J.texture,opacity:n,depthWrite:d})),N.createElement("orthographicCamera",{ref:L,args:[-t/2,t/2,r/2,-r/2,a,c]}))}),Lo=({meshPath:l="/meshes/macbook/mac-draco.glb",children:e})=>{const n=N.useRef(null),t=Fn(l,!0);console.log("GLTF",t);let{nodes:r,materials:s}=t;return nn(a=>{const c=a.clock.getElapsedTime(),i=n.current;i&&(i.rotation.x=Yt.lerp(i.rotation.x,Math.cos(c/2)/20+.25,.1),i.rotation.y=Yt.lerp(i.rotation.y,Math.sin(c/4)/20,.1),i.rotation.z=Yt.lerp(i.rotation.z,Math.sin(c/8)/20,.1),i.position.y=Yt.lerp(i.position.y,(-2+Math.sin(c/2))/2,.1))}),zt("group",{ref:n,dispose:null,children:[Fe("group",{"rotation-x":-.425,position:[0,-.04,.41],children:zt("group",{position:[0,2.96,-.13],rotation:[Math.PI/2,0,0],children:[Fe("mesh",{material:s.aluminium,geometry:r.Cube008.geometry}),Fe("mesh",{material:s["matte.001"],geometry:r.Cube008_1.geometry}),Fe("mesh",{geometry:r.Cube008_2.geometry,children:Fe(ca,{className:"content","rotation-x":-Math.PI/2,position:[0,.05,-.09],transform:!0,occlude:!0,children:Fe("div",{className:"wrapper",onPointerDown:a=>a.stopPropagation(),children:e})})})]})}),Fe("mesh",{material:s.keys,geometry:r.keyboard.geometry,position:[1.79,0,3.45]}),zt("group",{position:[0,-.1,3.39],children:[Fe("mesh",{material:s.aluminium,geometry:r.Cube002.geometry}),Fe("mesh",{material:s.trackpad,geometry:r.Cube002_1.geometry})]}),Fe("mesh",{material:s.touchbar,geometry:r.touchbar.geometry,position:[0,-.03,1.2]})]})},Oo=Gr.div`
  width: 100%;
  height: 100%;

  .content {
    margin-top: 27px;
    width: 334px;
    height: 216px;
    border-radius: 3px;
    overflow-y: auto;
    padding: 0;
  }

  .wrapper {
    padding: 10px;
    width: 668px;
    height: 432px;
    transform: scale(0.5);
    transform-origin: top left;
  }
`,Mn=({meshPath:l="/meshes/macbook/mac-draco.glb",children:e})=>Fe(Oo,{children:zt(zs,{camera:{position:[-5,0,-15],fov:55},children:[Fe("pointLight",{position:[10,10,10],intensity:1.5}),zt(N.Suspense,{fallback:null,children:[Fe("group",{rotation:[0,Math.PI,0],position:[0,1,0],children:Fe(Lo,{meshPath:l,children:e})}),Fe(_o,{preset:"city"})]}),Fe(xo,{position:[0,-4.5,0],scale:20,blur:2,far:4.5}),Fe(po,{enablePan:!1,enableZoom:!1,minPolarAngle:Math.PI/2.2,maxPolarAngle:Math.PI/2.2})]})});try{Mn.displayName="Macbook",Mn.__docgenInfo={description:"",displayName:"Macbook",props:{meshPath:{defaultValue:{value:"/meshes/macbook/mac-draco.glb"},description:"",name:"meshPath",required:!1,type:{name:"string"}}}}}catch{}const Xo={component:Mn,title:"gle-r3f-components/Macbook",argTypes:{}},Po=Gr.div`
  width: 100vw;
  height: 100vh;
`,Zt=l=>Fe(Po,{children:Fe(Mn,{meshPath:l.meshPath,children:Fe("h2",{children:"Hello World!"})})});Zt.args={meshPath:"./meshes/macbook/mac-draco.glb"};var Cr,gr,vr;Zt.parameters={...Zt.parameters,docs:{...(Cr=Zt.parameters)==null?void 0:Cr.docs,source:{originalSource:`(args: MacbookProps) => {
  return <MacbookContainer>
            <Macbook meshPath={args.meshPath}>
                <h2>Hello World!</h2>
            </Macbook>
        </MacbookContainer>;
}`,...(vr=(gr=Zt.parameters)==null?void 0:gr.docs)==null?void 0:vr.source}}};const jo=["Default"];export{Zt as Default,jo as __namedExportsOrder,Xo as default};
//# sourceMappingURL=Macbook.stories-97f963b7.js.map
